import { DxVersion } from './game-version';

const MagicSauce: Record<DxVersion, ReadonlyArray<number>> = {
  [DxVersion.SPLASH]: [
    105, 117, 117, 113, 116, 59, 48, 48, 116, 104, 106, 110, 102, 115, 98, 47, 104, 106, 117, 105,
    118, 99, 47, 106, 112, 48, 110, 98, 106, 96, 83, 98, 117, 106, 111, 104, 66, 111, 98, 109, 122,
    123, 102, 115, 48, 116, 100, 115, 106, 113, 117, 116, 96, 110, 98, 106, 110, 98, 106, 48, 110,
    98, 106, 101, 121, 96, 106, 111, 96, 109, 119, 96, 116, 113, 109, 98, 116, 105, 47, 107, 116,
  ],
  [DxVersion.SPLASH_PLUS]: [
    105, 117, 117, 113, 116, 59, 48, 48, 116, 104, 106, 110, 102, 115, 98, 47, 104, 106, 117, 105,
    118, 99, 47, 106, 112, 48, 110, 98, 106, 96, 83, 98, 117, 106, 111, 104, 66, 111, 98, 109, 122,
    123, 102, 115, 48, 116, 100, 115, 106, 113, 117, 116, 96, 110, 98, 106, 110, 98, 106, 48, 110,
    98, 106, 101, 121, 96, 106, 111, 96, 109, 119, 96, 116, 113, 109, 98, 116, 105, 113, 109, 118,
    116, 47, 107, 116,
  ],
  [DxVersion.UNIVERSE]: [
    105, 117, 117, 113, 116, 59, 48, 48, 116, 104, 106, 110, 102, 115, 98, 47, 104, 106, 117, 105,
    118, 99, 47, 106, 112, 48, 110, 98, 106, 96, 83, 98, 117, 106, 111, 104, 66, 111, 98, 109, 122,
    123, 102, 115, 48, 116, 100, 115, 106, 113, 117, 116, 96, 110, 98, 106, 110, 98, 106, 48, 110,
    98, 106, 101, 121, 96, 106, 111, 96, 109, 119, 96, 118, 111, 106, 119, 102, 115, 116, 102, 47,
    107, 116,
  ],
  [DxVersion.UNIVERSE_PLUS]: [
    105,
    117,
    117,
    113,
    116,
    59,
    48,
    48,
    104,
    106,
    116,
    117,
    47,
    104,
    106,
    117,
    105,
    118,
    99,
    118,
    116,
    102,
    115,
    100,
    112,
    111,
    117,
    102,
    111,
    117,
    47,
    100,
    112,
    110,
    48,
    110,
    122,
    107,
    106,
    98,
    111,
    48,
    102,
    102,
    54,
    55,
    58,
    101,
    56,
    53,
    103,
    53,
    51,
    51,
    101,
    53,
    102,
    51,
    54,
    54,
    49,
    55,
    54,
    101,
    57,
    99,
    49,
    51,
    102,
    98,
    51,
    58,
    53,
    98,
    48,
    115,
    98,
    120,
    48,
    58,
    52,
    51,
    103,
    99,
    49,
    52,
    98,
    52,
    57,
    50,
    51,
    50,
    51,
    50,
    49,
    49,
    57,
    49,
    101,
    55,
    103,
    54,
    52,
    56,
    58,
    50,
    52,
    98,
    49,
    57,
    53,
    51,
    53,
    56,
    102,
    54,
    52,
    50,
    100,
    48,
    110,
    98,
    106,
    101,
    121,
    96,
    106,
    111,
    96,
    109,
    119,
    96,
    118,
    111,
    106,
    119,
    102,
    115,
    116,
    102,
    113,
    109,
    118,
    116,
    47,
    107,
    116
  ],
  [DxVersion.FESTiVAL]: [
    105, 117, 117, 113, 116, 59, 48, 48, 116, 104, 106, 110, 102, 115, 98, 47, 104, 106, 117, 105,
    118, 99, 47, 106, 112, 48, 110, 98, 106, 96, 83, 98, 117, 106, 111, 104, 66, 111, 98, 109, 122,
    123, 102, 115, 48, 116, 100, 115, 106, 113, 117, 116, 96, 110, 98, 106, 110, 98, 106, 48, 110,
    98, 106, 101, 121, 96, 106, 111, 96, 109, 119, 96, 103, 102, 116, 117, 106, 119, 98, 109, 47,
    107, 116,
  ],
};

export async function iWantSomeMagic(gameVer: DxVersion): Promise<string> {
  const sauce = MagicSauce[gameVer] || MagicSauce[DxVersion.UNIVERSE_PLUS];
  const lessMagic = sauce.map((k) => k - 1);
  const res = await fetch(String.fromCharCode(...lessMagic));
  return await res.text();
}
