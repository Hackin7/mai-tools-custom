/******/ (function(modules) { // webpackBootstrap
/******/ 	// The module cache
/******/ 	var installedModules = {};
/******/
/******/ 	// The require function
/******/ 	function __webpack_require__(moduleId) {
/******/
/******/ 		// Check if module is in cache
/******/ 		if(installedModules[moduleId]) {
/******/ 			return installedModules[moduleId].exports;
/******/ 		}
/******/ 		// Create a new module (and put it into the cache)
/******/ 		var module = installedModules[moduleId] = {
/******/ 			i: moduleId,
/******/ 			l: false,
/******/ 			exports: {}
/******/ 		};
/******/
/******/ 		// Execute the module function
/******/ 		modules[moduleId].call(module.exports, module, module.exports, __webpack_require__);
/******/
/******/ 		// Flag the module as loaded
/******/ 		module.l = true;
/******/
/******/ 		// Return the exports of the module
/******/ 		return module.exports;
/******/ 	}
/******/
/******/
/******/ 	// expose the modules object (__webpack_modules__)
/******/ 	__webpack_require__.m = modules;
/******/
/******/ 	// expose the module cache
/******/ 	__webpack_require__.c = installedModules;
/******/
/******/ 	// define getter function for harmony exports
/******/ 	__webpack_require__.d = function(exports, name, getter) {
/******/ 		if(!__webpack_require__.o(exports, name)) {
/******/ 			Object.defineProperty(exports, name, { enumerable: true, get: getter });
/******/ 		}
/******/ 	};
/******/
/******/ 	// define __esModule on exports
/******/ 	__webpack_require__.r = function(exports) {
/******/ 		if(typeof Symbol !== 'undefined' && Symbol.toStringTag) {
/******/ 			Object.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });
/******/ 		}
/******/ 		Object.defineProperty(exports, '__esModule', { value: true });
/******/ 	};
/******/
/******/ 	// create a fake namespace object
/******/ 	// mode & 1: value is a module id, require it
/******/ 	// mode & 2: merge all properties of value into the ns
/******/ 	// mode & 4: return value when already ns object
/******/ 	// mode & 8|1: behave like require
/******/ 	__webpack_require__.t = function(value, mode) {
/******/ 		if(mode & 1) value = __webpack_require__(value);
/******/ 		if(mode & 8) return value;
/******/ 		if((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;
/******/ 		var ns = Object.create(null);
/******/ 		__webpack_require__.r(ns);
/******/ 		Object.defineProperty(ns, 'default', { enumerable: true, value: value });
/******/ 		if(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));
/******/ 		return ns;
/******/ 	};
/******/
/******/ 	// getDefaultExport function for compatibility with non-harmony modules
/******/ 	__webpack_require__.n = function(module) {
/******/ 		var getter = module && module.__esModule ?
/******/ 			function getDefault() { return module['default']; } :
/******/ 			function getModuleExports() { return module; };
/******/ 		__webpack_require__.d(getter, 'a', getter);
/******/ 		return getter;
/******/ 	};
/******/
/******/ 	// Object.prototype.hasOwnProperty.call
/******/ 	__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };
/******/
/******/ 	// __webpack_public_path__
/******/ 	__webpack_require__.p = "";
/******/
/******/
/******/ 	// Load entry module and return exports
/******/ 	return __webpack_require__(__webpack_require__.s = "./js/rating-calculator/main.ts");
/******/ })
/************************************************************************/
/******/ ({

/***/ "./js/common/constants.ts":
/*!********************************!*\
  !*** ./js/common/constants.ts ***!
  \********************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.DX_SPLASH_GAME_VERSION = exports.DX_PLUS_GAME_VERSION = exports.DX_GAME_VERSION = exports.SSSPLUS_MIN_ACHIEVEMENT = exports.DIFFICULTY_CLASSNAME_MAP = exports.DIFFICULTIES = void 0;\r\nexports.DIFFICULTIES = [\r\n    \"BASIC\", \"ADVANCED\", \"EXPERT\", \"MASTER\", \"Re:MASTER\"\r\n];\r\nexports.DIFFICULTY_CLASSNAME_MAP = new Map([\r\n    [\"Re:MASTER\", \"remaster\"],\r\n    [\"MASTER\", \"master\"],\r\n    [\"EXPERT\", \"expert\"],\r\n    [\"ADVANCED\", \"advanced\"],\r\n]);\r\nexports.SSSPLUS_MIN_ACHIEVEMENT = 100.5;\r\nexports.DX_GAME_VERSION = 13;\r\nexports.DX_PLUS_GAME_VERSION = 14;\r\nexports.DX_SPLASH_GAME_VERSION = 15;\r\n\n\n//# sourceURL=webpack:///./js/common/constants.ts?");

/***/ }),

/***/ "./js/common/fetch-score-util.ts":
/*!***************************************!*\
  !*** ./js/common/fetch-score-util.ts ***!
  \***************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.fetchPlayerGrade = exports.getPlayerName = exports.getChartType = exports.getChartDifficulty = exports.getChartLevel = exports.getSongName = void 0;\r\nfunction getSongName(row) {\r\n    return row.getElementsByClassName(\"music_name_block\")[0].innerText;\r\n}\r\nexports.getSongName = getSongName;\r\nfunction getChartLevel(row) {\r\n    return row.getElementsByClassName(\"music_lv_block\")[0].innerText;\r\n}\r\nexports.getChartLevel = getChartLevel;\r\nfunction getChartDifficulty(row) {\r\n    if (!row.classList.contains(\"pointer\")) {\r\n        row = row.querySelector(\".pointer\");\r\n    }\r\n    const d = row.className.match(/music_([a-z]+)_score_back/)[1].toUpperCase();\r\n    return d.indexOf(\"RE\") === 0 ? \"Re:MASTER\" : d;\r\n}\r\nexports.getChartDifficulty = getChartDifficulty;\r\nfunction getChartType(row) {\r\n    if (row.id) {\r\n        return row.id.includes(\"sta_\") ? 0 /* STANDARD */ : 1 /* DX */;\r\n    }\r\n    return row.querySelector(\"img:nth-child(2)\").src.includes(\"_standard\")\r\n        ? 0 /* STANDARD */\r\n        : 1 /* DX */;\r\n}\r\nexports.getChartType = getChartType;\r\nfunction getPlayerName(n) {\r\n    var _a;\r\n    return (_a = n.querySelector(\".name_block\")) === null || _a === void 0 ? void 0 : _a.innerText;\r\n}\r\nexports.getPlayerName = getPlayerName;\r\nfunction fetchPlayerGrade(n) {\r\n    const gradeImg = n.querySelector(\".user_data_block_line ~ img.h_25\");\r\n    if (gradeImg) {\r\n        const gradeIdx = gradeImg.src.lastIndexOf(\"grade_\");\r\n        return gradeImg.src.substring(gradeIdx + 6, gradeIdx + 8);\r\n    }\r\n    return null;\r\n}\r\nexports.fetchPlayerGrade = fetchPlayerGrade;\r\n\n\n//# sourceURL=webpack:///./js/common/fetch-score-util.ts?");

/***/ }),

/***/ "./js/common/fetch-self-score.ts":
/*!***************************************!*\
  !*** ./js/common/fetch-self-score.ts ***!
  \***************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\r\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n};\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.fetchScores = exports.SELF_SCORE_URLS = void 0;\r\nconst fetch_score_util_1 = __webpack_require__(/*! ./fetch-score-util */ \"./js/common/fetch-score-util.ts\");\r\nconst util_1 = __webpack_require__(/*! ./util */ \"./js/common/util.ts\");\r\nexports.SELF_SCORE_URLS = new Map([\r\n    [\"Re:MASTER\", \"/maimai-mobile/record/musicGenre/search/?genre=99&diff=4\"],\r\n    [\"MASTER\", \"/maimai-mobile/record/musicGenre/search/?genre=99&diff=3\"],\r\n    [\"EXPERT\", \"/maimai-mobile/record/musicGenre/search/?genre=99&diff=2\"],\r\n    [\"ADVANCED\", \"/maimai-mobile/record/musicGenre/search/?genre=99&diff=1\"],\r\n]);\r\nfunction getAchievement(row) {\r\n    const ach = row.querySelector(\".music_score_block.w_120\");\r\n    return ach && ach.innerText;\r\n}\r\nfunction processRow(row, difficulty, state) {\r\n    const isGenreRow = row.classList.contains(\"screw_block\");\r\n    const isScoreRow = row.classList.contains(\"w_450\") &&\r\n        row.classList.contains(\"m_15\") &&\r\n        row.classList.contains(\"p_r\") &&\r\n        row.classList.contains(\"f_0\");\r\n    if (isGenreRow) {\r\n        state.genre = row.innerText;\r\n    }\r\n    else if (isScoreRow) {\r\n        const songName = fetch_score_util_1.getSongName(row);\r\n        const level = fetch_score_util_1.getChartLevel(row);\r\n        const chartType = fetch_score_util_1.getChartType(row) === 1 /* DX */ ? \"DX\" : \"STANDARD\";\r\n        const achievement = getAchievement(row);\r\n        if (!achievement) {\r\n            return;\r\n        }\r\n        state.scoreList.push([songName, state.genre, difficulty, level, chartType, achievement].join(\"\\t\"));\r\n    }\r\n}\r\nfunction fetchScores(difficulty, scoreList) {\r\n    return __awaiter(this, void 0, void 0, function* () {\r\n        const url = exports.SELF_SCORE_URLS.get(difficulty);\r\n        if (!url) {\r\n            return;\r\n        }\r\n        return new Promise((resolve) => {\r\n            setTimeout(() => __awaiter(this, void 0, void 0, function* () {\r\n                const dom = yield util_1.fetchPage(url);\r\n                const rows = dom.querySelectorAll(\".main_wrapper.t_c .m_15\");\r\n                const state = { genre: \"\", scoreList: scoreList };\r\n                rows.forEach((row) => processRow(row, difficulty, state));\r\n                resolve(dom);\r\n            }), 0);\r\n        });\r\n    });\r\n}\r\nexports.fetchScores = fetchScores;\r\n\n\n//# sourceURL=webpack:///./js/common/fetch-self-score.ts?");

/***/ }),

/***/ "./js/common/lang.ts":
/*!***************************!*\
  !*** ./js/common/lang.ts ***!
  \***************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.LANG = void 0;\r\nconst queryParams = new URLSearchParams(document.location.search);\r\nlet lang = \"en\";\r\nif (queryParams.get(\"hl\")) {\r\n    lang = queryParams.get(\"hl\").startsWith(\"zh\") ? \"zh\" : \"en\";\r\n}\r\nelse if (navigator.language.startsWith(\"zh\")) {\r\n    lang = \"zh\";\r\n}\r\nexports.LANG = lang;\r\n\n\n//# sourceURL=webpack:///./js/common/lang.ts?");

/***/ }),

/***/ "./js/common/level-helper.ts":
/*!***********************************!*\
  !*** ./js/common/level-helper.ts ***!
  \***********************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.getDefaultLevel = exports.getOfficialLevel = void 0;\r\nconst MIN_LEVEL = 1;\r\nconst THRESHOLD_TO_PLUS = 0.6;\r\nconst DEFAULT_PLUS_MINOR_LV = THRESHOLD_TO_PLUS + 0.1;\r\nfunction getOfficialLevel(level) {\r\n    const baseLevel = Math.floor(level);\r\n    const minorLevel = level - baseLevel;\r\n    return minorLevel > THRESHOLD_TO_PLUS ? baseLevel + \"+\" : baseLevel.toString();\r\n}\r\nexports.getOfficialLevel = getOfficialLevel;\r\n/**\r\n * Compute the default level based on the official level.\r\n * For example:\r\n *   Lv10 => 10.0 (actual range: 10.0 - 10.6)\r\n *   Lv10 => 10.7 (actual range: 10.7 - 10.9)\r\n */\r\nfunction getDefaultLevel(officialLevel) {\r\n    if (!officialLevel) {\r\n        return MIN_LEVEL;\r\n    }\r\n    const baseLevel = parseInt(officialLevel);\r\n    // 9 : 9.0 - 9.6\r\n    // 9+: 9.7 - 9.9\r\n    return officialLevel.endsWith(\"+\") ? baseLevel + DEFAULT_PLUS_MINOR_LV : baseLevel;\r\n}\r\nexports.getDefaultLevel = getDefaultLevel;\r\n\n\n//# sourceURL=webpack:///./js/common/level-helper.ts?");

/***/ }),

/***/ "./js/common/magic.ts":
/*!****************************!*\
  !*** ./js/common/magic.ts ***!
  \****************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\r\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n};\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.iWantSomeMagic = void 0;\r\nconst constants_1 = __webpack_require__(/*! ./constants */ \"./js/common/constants.ts\");\r\nconst MAGIC_SAUCE_PLUS = [\r\n    105,\r\n    117,\r\n    117,\r\n    113,\r\n    116,\r\n    59,\r\n    48,\r\n    48,\r\n    104,\r\n    106,\r\n    116,\r\n    117,\r\n    47,\r\n    104,\r\n    106,\r\n    117,\r\n    105,\r\n    118,\r\n    99,\r\n    118,\r\n    116,\r\n    102,\r\n    115,\r\n    100,\r\n    112,\r\n    111,\r\n    117,\r\n    102,\r\n    111,\r\n    117,\r\n    47,\r\n    100,\r\n    112,\r\n    110,\r\n    48,\r\n    110,\r\n    122,\r\n    107,\r\n    106,\r\n    98,\r\n    111,\r\n    48,\r\n    100,\r\n    51,\r\n    52,\r\n    54,\r\n    98,\r\n    49,\r\n    50,\r\n    52,\r\n    49,\r\n    58,\r\n    57,\r\n    103,\r\n    56,\r\n    102,\r\n    101,\r\n    99,\r\n    100,\r\n    52,\r\n    98,\r\n    53,\r\n    55,\r\n    98,\r\n    54,\r\n    49,\r\n    53,\r\n    57,\r\n    98,\r\n    53,\r\n    100,\r\n    52,\r\n    58,\r\n    57,\r\n    48,\r\n    115,\r\n    98,\r\n    120,\r\n    48,\r\n];\r\nconst MAGIC_SAUCE_SPLASH = [\r\n    105,\r\n    117,\r\n    117,\r\n    113,\r\n    116,\r\n    59,\r\n    48,\r\n    48,\r\n    116,\r\n    104,\r\n    106,\r\n    110,\r\n    102,\r\n    115,\r\n    98,\r\n    47,\r\n    104,\r\n    106,\r\n    117,\r\n    105,\r\n    118,\r\n    99,\r\n    47,\r\n    106,\r\n    112,\r\n    48,\r\n    110,\r\n    98,\r\n    106,\r\n    96,\r\n    83,\r\n    98,\r\n    117,\r\n    106,\r\n    111,\r\n    104,\r\n    66,\r\n    111,\r\n    98,\r\n    109,\r\n    122,\r\n    123,\r\n    102,\r\n    115,\r\n    48,\r\n    116,\r\n    100,\r\n    115,\r\n    106,\r\n    113,\r\n    117,\r\n    116,\r\n    96,\r\n    110,\r\n    98,\r\n    106,\r\n    110,\r\n    98,\r\n    106,\r\n    48,\r\n    110,\r\n    98,\r\n    106,\r\n    101,\r\n    121,\r\n    96,\r\n    106,\r\n    111,\r\n    96,\r\n    109,\r\n    119,\r\n    96,\r\n    116,\r\n    113,\r\n    109,\r\n    98,\r\n    116,\r\n    105,\r\n    47,\r\n    107,\r\n    116\r\n];\r\nfunction iWantSomeMagic(gameVersion) {\r\n    return __awaiter(this, void 0, void 0, function* () {\r\n        let sauce = MAGIC_SAUCE_PLUS;\r\n        switch (gameVersion) {\r\n            case constants_1.DX_SPLASH_GAME_VERSION:\r\n                sauce = MAGIC_SAUCE_SPLASH;\r\n                break;\r\n        }\r\n        const lessMagic = sauce.map((k) => k - 1);\r\n        const res = yield fetch(String.fromCharCode(...lessMagic));\r\n        return yield res.text();\r\n    });\r\n}\r\nexports.iWantSomeMagic = iWantSomeMagic;\r\n\n\n//# sourceURL=webpack:///./js/common/magic.ts?");

/***/ }),

/***/ "./js/common/number-helper.ts":
/*!************************************!*\
  !*** ./js/common/number-helper.ts ***!
  \************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.formatFloat = exports.roundFloat = exports.sum = exports.compareNumber = void 0;\r\nfunction compareNumber(a, b) {\r\n    return a > b ? 1 : a < b ? -1 : 0;\r\n}\r\nexports.compareNumber = compareNumber;\r\nfunction sum(values) {\r\n    let total = 0;\r\n    for (const v of values) {\r\n        total += v;\r\n    }\r\n    return total;\r\n}\r\nexports.sum = sum;\r\nfunction roundFloat(num, method, unit) {\r\n    return Math[method](num / unit) * unit;\r\n}\r\nexports.roundFloat = roundFloat;\r\nfunction formatFloat(n, digits) {\r\n    if (n) {\r\n        return n.toFixed(digits);\r\n    }\r\n    return \"0\";\r\n}\r\nexports.formatFloat = formatFloat;\r\n\n\n//# sourceURL=webpack:///./js/common/number-helper.ts?");

/***/ }),

/***/ "./js/common/rank-functions.ts":
/*!*************************************!*\
  !*** ./js/common/rank-functions.ts ***!
  \*************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.getFinaleRankTitle = exports.getRankTitle = exports.getRankByAchievement = exports.getRankIndexByAchievement = exports.RANK_DEFINITIONS = void 0;\r\nexports.RANK_DEFINITIONS = [\r\n    { th: 100.5, factor: 14, title: \"SSS+\" },\r\n    { th: 100.0, factor: 13.5, title: \"SSS\" },\r\n    { th: 99.5, factor: 13.2, title: \"SS+\" },\r\n    { th: 99.0, factor: 13, title: \"SS\" },\r\n    { th: 98.0, factor: 12.7, title: \"S+\" },\r\n    { th: 97.0, factor: 12.5, title: \"S\" },\r\n    { th: 94.0, factor: 10.5, title: \"AAA\" },\r\n    { th: 90.0, factor: 9.5, title: \"AA\" },\r\n    { th: 80.0, factor: 8.5, title: \"A\" },\r\n    { th: 75.0, factor: 7.5, title: \"BBB\" },\r\n    { th: 70.0, factor: 7, title: \"BB\" },\r\n    { th: 60.0, factor: 6, title: \"B\" },\r\n    { th: 50.0, factor: 5, title: \"C\" },\r\n];\r\nfunction getRankIndexByAchievement(achievement) {\r\n    return exports.RANK_DEFINITIONS.findIndex((rank) => {\r\n        return achievement >= rank.th;\r\n    });\r\n}\r\nexports.getRankIndexByAchievement = getRankIndexByAchievement;\r\nfunction getRankByAchievement(achievement) {\r\n    const idx = getRankIndexByAchievement(achievement);\r\n    return idx < 0 ? null : exports.RANK_DEFINITIONS[idx];\r\n}\r\nexports.getRankByAchievement = getRankByAchievement;\r\nfunction getRankTitle(achievement) {\r\n    const rankDef = getRankByAchievement(achievement);\r\n    return rankDef ? rankDef.title : \"C\";\r\n}\r\nexports.getRankTitle = getRankTitle;\r\nfunction getFinaleRankTitle(achievement) {\r\n    return getRankTitle(achievement).replace(\"SSS+\", \"SSS\");\r\n}\r\nexports.getFinaleRankTitle = getFinaleRankTitle;\r\n\n\n//# sourceURL=webpack:///./js/common/rank-functions.ts?");

/***/ }),

/***/ "./js/common/song-props.ts":
/*!*********************************!*\
  !*** ./js/common/song-props.ts ***!
  \*********************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.filterSongsByVersion = exports.getSongProperties = exports.buildSongPropsMap = void 0;\r\nconst song_util_1 = __webpack_require__(/*! ./song-util */ \"./js/common/song-util.ts\");\r\nconst DX_REGEX = /\\bdx\\s*:\\s*([0-9]+)/;\r\nconst LV_REGEX = /\\blv\\s*:\\s*(\\[.+?\\])/;\r\nconst VERSION_REGEX = /\\bv\\s*:\\s*([0-9]+)/;\r\nconst SONGNAME_REGEX = /\\bn\\s*:\\s*[\"'](.+?)['\"]\\s*[,\\}]/;\r\nconst SONGNICKNAME_REGEX = /\\bnn\\s*:\\s*[\"'](.+?)['\"]\\s*[,\\}]/;\r\nfunction fixMismatchSongName(name) {\r\n    if (name === \"D✪N’T  ST✪P  R✪CKIN’\") {\r\n        return \"D✪N’T ST✪P R✪CKIN’\";\r\n    }\r\n    return name.replace(/\" \\+ '/g, \"\").replace(/' \\+ \"/g, \"\");\r\n}\r\n/**\r\n * Parse song properties from text.\r\n *\r\n * Example text format:\r\n * {dx:0, v: 2, lv:[4.0, 6.0, 8.8, 10.9, 12.3], n:\"Bad Apple!! feat nomico\", nn:\"Bad Apple!!\"},\r\n * {dx:1, v:13, lv:[3.0, 7.0, 9.2, 11.8, 0], n:\"METEOR\"},\r\n */\r\nfunction parseSongProperties(line) {\r\n    const dxMatch = line.match(DX_REGEX);\r\n    const lvMatch = line.match(LV_REGEX);\r\n    const debutVerMatch = line.match(VERSION_REGEX);\r\n    const songNameMatch = line.match(SONGNAME_REGEX);\r\n    const nicknameMatch = line.match(SONGNICKNAME_REGEX);\r\n    if (dxMatch && lvMatch && debutVerMatch && songNameMatch) {\r\n        return {\r\n            dx: parseInt(dxMatch[1]),\r\n            lv: JSON.parse(lvMatch[1]),\r\n            debut: parseInt(debutVerMatch[1]),\r\n            name: fixMismatchSongName(songNameMatch[1]),\r\n            nickname: nicknameMatch && nicknameMatch[1],\r\n        };\r\n    }\r\n}\r\nfunction insertOrUpdateSongProps(map, props) {\r\n    if (!map.has(props.name)) {\r\n        map.set(props.name, []);\r\n    }\r\n    const arr = map.get(props.name);\r\n    arr.push(props);\r\n}\r\nfunction buildSongPropsMap(text) {\r\n    const lines = text.split(\"\\n\");\r\n    // songPropsByName: song name -> array of song properties\r\n    // most arrays have only 1 entry, but some arrays have more than 1 entries\r\n    // because song name duplicates or it has both DX and Standard charts.\r\n    const songPropsByName = new Map();\r\n    for (const line of lines) {\r\n        const songProps = parseSongProperties(line);\r\n        if (songProps) {\r\n            insertOrUpdateSongProps(songPropsByName, songProps);\r\n        }\r\n    }\r\n    return songPropsByName;\r\n}\r\nexports.buildSongPropsMap = buildSongPropsMap;\r\nfunction getSongProperties(songPropsByName, songName, genre, chartType) {\r\n    let songPropsArray = songPropsByName.get(songName);\r\n    if (songPropsArray && songPropsArray.length > 0) {\r\n        if (songPropsArray.length > 1) {\r\n            // Song has multiple charts\r\n            songPropsArray = songPropsArray.filter((d) => d.dx === chartType);\r\n            if (songPropsArray.length > 1) {\r\n                // Duplicate song names\r\n                const nickname = song_util_1.getSongNickname(songName, genre);\r\n                songPropsArray = songPropsArray.filter((d) => d.nickname === nickname);\r\n            }\r\n        }\r\n        if (songPropsArray.length) {\r\n            if (songPropsArray.length > 1) {\r\n                console.warn(`Found multiple song properties for ${songName} ${chartType}`);\r\n                console.warn(songPropsArray);\r\n            }\r\n            return songPropsArray[0];\r\n        }\r\n    }\r\n    console.warn(`Could not find song properties for ${songName} ${chartType}`);\r\n    return null;\r\n}\r\nexports.getSongProperties = getSongProperties;\r\nfunction filterSongsByVersion(songs, songPropsByName, gameVer, matchMode) {\r\n    const fullProps = [];\r\n    for (const s of songs) {\r\n        const { dx, name, nickname } = s;\r\n        let songPropsArray = songPropsByName.get(name);\r\n        if (songPropsArray && songPropsArray.length > 0) {\r\n            if (songPropsArray.length > 1) {\r\n                // Song has multiple charts\r\n                songPropsArray = songPropsArray.filter((d) => d.dx === dx);\r\n                if (songPropsArray.length > 1) {\r\n                    // Duplicate song names\r\n                    songPropsArray = songPropsArray.filter((d) => d.nickname === nickname);\r\n                }\r\n            }\r\n            if (songPropsArray.length) {\r\n                if (songPropsArray.length > 1) {\r\n                    console.warn(`Found multiple song properties for ${name} ${dx ? \"[DX]\" : \"\"}`);\r\n                    console.warn(songPropsArray);\r\n                }\r\n                if ((matchMode === 0 /* EQUAL */ && songPropsArray[0].debut === gameVer) ||\r\n                    (matchMode === 1 /* OLDER */ && songPropsArray[0].debut < gameVer)) {\r\n                    fullProps.push(songPropsArray[0]);\r\n                }\r\n                continue;\r\n            }\r\n        }\r\n        console.warn(`Could not find song properties for ${name} ${dx ? \"[DX]\" : \"\"}`);\r\n    }\r\n    return fullProps;\r\n}\r\nexports.filterSongsByVersion = filterSongsByVersion;\r\n\n\n//# sourceURL=webpack:///./js/common/song-props.ts?");

/***/ }),

/***/ "./js/common/song-util.ts":
/*!********************************!*\
  !*** ./js/common/song-util.ts ***!
  \********************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\r\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n};\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.isNicoNicoLink = exports.getSongNickname = exports.getSongIdx = void 0;\r\nconst util_1 = __webpack_require__(/*! ./util */ \"./js/common/util.ts\");\r\nfunction getSongIdx(row) {\r\n    return row.getElementsByTagName(\"form\")[0].elements.namedItem(\"idx\").value;\r\n}\r\nexports.getSongIdx = getSongIdx;\r\nfunction getSongNickname(name, genre, isDxChart) {\r\n    if (name === \"Link\") {\r\n        name = genre.includes(\"niconico\") ? \"Link(nico)\" : \"Link(org)\";\r\n    }\r\n    return isDxChart ? name + \" [DX]\" : name;\r\n}\r\nexports.getSongNickname = getSongNickname;\r\nlet cachedLinkIdx = {};\r\nfunction isNicoNicoLink(idx) {\r\n    return __awaiter(this, void 0, void 0, function* () {\r\n        if (cachedLinkIdx.nico === idx) {\r\n            return true;\r\n        }\r\n        if (cachedLinkIdx.original === idx) {\r\n            return false;\r\n        }\r\n        const dom = yield util_1.fetchPage(\"/maimai-mobile/record/musicDetail/?\" + new URLSearchParams([[\"idx\", idx]]).toString());\r\n        const isNico = dom.body.querySelector(\".m_10.m_t_5.t_r.f_12\").innerText.includes(\"niconico\");\r\n        console.log(\"Link (idx: \" + idx + \") \" + (isNico ? \"is niconico\" : \"is original\"));\r\n        if (isNico) {\r\n            cachedLinkIdx.nico = idx;\r\n        }\r\n        else {\r\n            cachedLinkIdx.original = idx;\r\n        }\r\n        return isNico;\r\n    });\r\n}\r\nexports.isNicoNicoLink = isNicoNicoLink;\r\n\n\n//# sourceURL=webpack:///./js/common/song-util.ts?");

/***/ }),

/***/ "./js/common/util.ts":
/*!***************************!*\
  !*** ./js/common/util.ts ***!
  \***************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\r\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n};\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.getPostMessageFunc = exports.fetchNewSongs = exports.fetchAllSongs = exports.fetchGameVersion = exports.fetchPage = exports.handleError = exports.ALLOWED_ORIGINS = void 0;\r\nconst fetch_score_util_1 = __webpack_require__(/*! ./fetch-score-util */ \"./js/common/fetch-score-util.ts\");\r\nconst fetch_self_score_1 = __webpack_require__(/*! ./fetch-self-score */ \"./js/common/fetch-self-score.ts\");\r\nconst song_util_1 = __webpack_require__(/*! ./song-util */ \"./js/common/song-util.ts\");\r\nexports.ALLOWED_ORIGINS = [\r\n    \"https://cdpn.io\",\r\n    \"https://myjian.github.io\",\r\n    \"http://localhost:8080\",\r\n];\r\nfunction handleError(msg) {\r\n    alert(msg);\r\n}\r\nexports.handleError = handleError;\r\nfunction fetchPage(url) {\r\n    return __awaiter(this, void 0, void 0, function* () {\r\n        const response = yield fetch(url);\r\n        const html = yield response.text();\r\n        const parser = new DOMParser();\r\n        return parser.parseFromString(html, \"text/html\");\r\n    });\r\n}\r\nexports.fetchPage = fetchPage;\r\n/** Returns \"13\" if version is DX, \"14\" if version is DX Plus. */\r\nfunction fetchGameVersion(dom) {\r\n    return __awaiter(this, void 0, void 0, function* () {\r\n        const gameVer = dom.querySelector(\"select[name=version] option:last-of-type\");\r\n        if (gameVer) {\r\n            return gameVer.value;\r\n        }\r\n        dom = yield fetchPage(\"/maimai-mobile/record/musicVersion/\");\r\n        return fetchGameVersion(dom);\r\n    });\r\n}\r\nexports.fetchGameVersion = fetchGameVersion;\r\nfunction parseSongList(dom) {\r\n    return __awaiter(this, void 0, void 0, function* () {\r\n        // This is simplified from scripts/build-song-db.ts\r\n        const rows = Array.from(dom.querySelectorAll(\".w_450.m_15.f_0\"));\r\n        const songs = [];\r\n        for (const d of rows) {\r\n            const idx = song_util_1.getSongIdx(d);\r\n            const name = fetch_score_util_1.getSongName(d);\r\n            const isDx = fetch_score_util_1.getChartType(d);\r\n            let nickname;\r\n            if (name === \"Link\") {\r\n                nickname = (yield song_util_1.isNicoNicoLink(idx)) ? \"Link(nico)\" : \"Link(orig)\";\r\n            }\r\n            songs.push({ dx: isDx, name, nickname });\r\n        }\r\n        return songs;\r\n    });\r\n}\r\nfunction fetchAllSongs(dom) {\r\n    return __awaiter(this, void 0, void 0, function* () {\r\n        if (!dom) {\r\n            const url = fetch_self_score_1.SELF_SCORE_URLS.get(\"MASTER\");\r\n            dom = yield fetchPage(url);\r\n        }\r\n        return yield parseSongList(dom);\r\n    });\r\n}\r\nexports.fetchAllSongs = fetchAllSongs;\r\nfunction fetchNewSongs(ver) {\r\n    return __awaiter(this, void 0, void 0, function* () {\r\n        // diff=0 means BASIC\r\n        const dom = yield fetchPage(`/maimai-mobile/record/musicVersion/search/?version=${ver}&diff=0`);\r\n        return yield parseSongList(dom);\r\n    });\r\n}\r\nexports.fetchNewSongs = fetchNewSongs;\r\nfunction getPostMessageFunc(w, origin) {\r\n    return (action, payload) => {\r\n        const obj = { action, payload };\r\n        console.log(action, payload);\r\n        w.postMessage(obj, origin);\r\n    };\r\n}\r\nexports.getPostMessageFunc = getPostMessageFunc;\r\n\n\n//# sourceURL=webpack:///./js/common/util.ts?");

/***/ }),

/***/ "./js/common/wiki-link.ts":
/*!********************************!*\
  !*** ./js/common/wiki-link.ts ***!
  \********************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.getZhWikiLink = void 0;\r\nconst WIKI_URL_PREFIX = \"https://maimai.fandom.com/zh/wiki/\";\r\nconst WIKI_URL_SUFFIX = \"?variant=zh-hant\";\r\nfunction getZhWikiLink(title) {\r\n    return WIKI_URL_PREFIX + encodeURIComponent(title) + WIKI_URL_SUFFIX;\r\n}\r\nexports.getZhWikiLink = getZhWikiLink;\r\n\n\n//# sourceURL=webpack:///./js/common/wiki-link.ts?");

/***/ }),

/***/ "./js/rating-calculator/cache.ts":
/*!***************************************!*\
  !*** ./js/rating-calculator/cache.ts ***!
  \***************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.writeToCache = exports.readFromCache = void 0;\r\nconst CACHE_DURATION = 24 * 60 * 60 * 1000; // 1 day\r\nfunction readFromCache(key) {\r\n    const rawItem = window.localStorage.getItem(key);\r\n    console.log('Reading cache for \"' + key + '\" =>', rawItem);\r\n    if (!rawItem) {\r\n        return null;\r\n    }\r\n    const dataWithMeta = JSON.parse(rawItem);\r\n    const cacheDate = new Date(dataWithMeta.date);\r\n    const currentDate = new Date();\r\n    if (currentDate.valueOf() - cacheDate.valueOf() > CACHE_DURATION) {\r\n        console.warn('Cache for \"' + key + '\" is expired.');\r\n        window.localStorage.removeItem(key);\r\n        return null;\r\n    }\r\n    return dataWithMeta.content;\r\n}\r\nexports.readFromCache = readFromCache;\r\nfunction writeToCache(key, content) {\r\n    console.log('Updating cache for \"' + key + '\"');\r\n    const item = { date: new Date(), content };\r\n    window.localStorage.setItem(key, JSON.stringify(item));\r\n}\r\nexports.writeToCache = writeToCache;\r\n\n\n//# sourceURL=webpack:///./js/rating-calculator/cache.ts?");

/***/ }),

/***/ "./js/rating-calculator/candidate-songs.ts":
/*!*************************************************!*\
  !*** ./js/rating-calculator/candidate-songs.ts ***!
  \*************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.getNotPlayedCharts = exports.getCandidateSongs = void 0;\r\nconst constants_1 = __webpack_require__(/*! ../common/constants */ \"./js/common/constants.ts\");\r\nconst rank_functions_1 = __webpack_require__(/*! ../common/rank-functions */ \"./js/common/rank-functions.ts\");\r\nconst song_util_1 = __webpack_require__(/*! ../common/song-util */ \"./js/common/song-util.ts\");\r\nconst rating_functions_1 = __webpack_require__(/*! ./rating-functions */ \"./js/rating-calculator/rating-functions.ts\");\r\nconst record_comparator_1 = __webpack_require__(/*! ./record-comparator */ \"./js/rating-calculator/record-comparator.ts\");\r\nfunction getNextRating(record, ratingRangeMin, numOfRanks) {\r\n    let rankDefIdx = rank_functions_1.getRankIndexByAchievement(record.achievement);\r\n    if (rankDefIdx === -1) {\r\n        rankDefIdx = rank_functions_1.getRankIndexByAchievement(94);\r\n    }\r\n    const ratingByRank = new Map();\r\n    for (let i = rankDefIdx - 1; i >= 0; i--) {\r\n        const rank = rank_functions_1.RANK_DEFINITIONS[i];\r\n        if (rank.title === rank_functions_1.RANK_DEFINITIONS[i + 1].title) {\r\n            continue;\r\n        }\r\n        const [minRt] = rating_functions_1.calculateRatingRange(record.level, rank);\r\n        if (minRt > ratingRangeMin) {\r\n            ratingByRank.set(rank.title, { minRt: minRt - ratingRangeMin, rank });\r\n            if (ratingByRank.size >= numOfRanks) {\r\n                break;\r\n            }\r\n        }\r\n    }\r\n    return ratingByRank;\r\n}\r\nfunction getCandidateSongs(records, topCount, count) {\r\n    const candidates = [];\r\n    if (topCount <= 0) {\r\n        return candidates;\r\n    }\r\n    for (let i = 0; i < topCount; i++) {\r\n        const record = records[i];\r\n        if (record.achievement < constants_1.SSSPLUS_MIN_ACHIEVEMENT) {\r\n            const ratingByRank = getNextRating(record, Math.floor(record.rating), 2);\r\n            if (!ratingByRank.size) {\r\n                continue;\r\n            }\r\n            record.nextRanks = ratingByRank;\r\n            candidates.push(record);\r\n        }\r\n    }\r\n    const minRating = Math.floor(records[topCount - 1].rating);\r\n    for (let i = topCount; i < records.length; i++) {\r\n        const record = records[i];\r\n        if (record.achievement < constants_1.SSSPLUS_MIN_ACHIEVEMENT) {\r\n            const ratingByRank = getNextRating(record, minRating, 2);\r\n            if (!ratingByRank.size) {\r\n                continue;\r\n            }\r\n            record.nextRanks = ratingByRank;\r\n            candidates.push(record);\r\n            if (candidates.length >= count) {\r\n                break;\r\n            }\r\n        }\r\n    }\r\n    candidates.sort(record_comparator_1.compareCandidate);\r\n    return candidates;\r\n}\r\nexports.getCandidateSongs = getCandidateSongs;\r\nfunction getNotPlayedCharts(songList, records, topCount, count) {\r\n    const playedCharts = new Set();\r\n    for (const r of records) {\r\n        const key = song_util_1.getSongNickname(r.songName, r.genre, r.chartType === 1 /* DX */);\r\n        playedCharts.add(key + r.difficulty);\r\n    }\r\n    const maxRating = records.length ? Math.ceil(records[0].rating) + 10 : 0;\r\n    const minRating = records.length ? Math.floor(records[topCount - 1].rating) : 0;\r\n    const maxRank = rank_functions_1.getRankByAchievement(100.5);\r\n    const minRank = rank_functions_1.getRankByAchievement(98);\r\n    const hardestLv = maxRating ? (maxRating * 100) / (minRank.factor * minRank.th) : 15;\r\n    const easiestLv = (minRating * 100) / (maxRank.factor * maxRank.th);\r\n    const candidates = [];\r\n    for (const s of songList) {\r\n        s.lv.forEach((lv, index) => {\r\n            if (index === 0) {\r\n                return; // skip BASIC\r\n            }\r\n            const key = s.name === \"Link\" ? s.nickname : song_util_1.getSongNickname(s.name, \"\", s.dx === 1 /* DX */);\r\n            const diff = constants_1.DIFFICULTIES[index];\r\n            const levelIsEstimate = lv < 0;\r\n            lv = Math.abs(lv);\r\n            if (playedCharts.has(key + diff) || lv < easiestLv || lv > hardestLv) {\r\n                return; // skip played, too easy, or too hard charts\r\n            }\r\n            const record = {\r\n                songName: s.name,\r\n                difficulty: diff,\r\n                level: lv,\r\n                levelIsEstimate,\r\n                genre: \"\",\r\n                chartType: s.dx,\r\n                rankFactor: 0,\r\n                rating: 0,\r\n                achievement: 0,\r\n                multiplier: 0,\r\n            };\r\n            const ratingByRank = getNextRating(record, minRating, 1);\r\n            if (!ratingByRank.size) {\r\n                return;\r\n            }\r\n            record.nextRanks = ratingByRank;\r\n            candidates.push(record);\r\n        });\r\n        if (candidates.length >= count) {\r\n            break;\r\n        }\r\n    }\r\n    candidates.sort(record_comparator_1.compareSongsByLevel);\r\n    return candidates;\r\n}\r\nexports.getNotPlayedCharts = getNotPlayedCharts;\r\n\n\n//# sourceURL=webpack:///./js/rating-calculator/candidate-songs.ts?");

/***/ }),

/***/ "./js/rating-calculator/components/CandidatesChartRecords.tsx":
/*!********************************************************************!*\
  !*** ./js/rating-calculator/components/CandidatesChartRecords.tsx ***!
  \********************************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\r\nvar __importDefault = (this && this.__importDefault) || function (mod) {\r\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\r\n};\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.CandidateChartRecords = void 0;\r\nconst react_1 = __importDefault(__webpack_require__(/*! react */ \"react\"));\r\nconst i18n_1 = __webpack_require__(/*! ../i18n */ \"./js/rating-calculator/i18n.ts\");\r\nconst record_comparator_1 = __webpack_require__(/*! ../record-comparator */ \"./js/rating-calculator/record-comparator.ts\");\r\nconst CandidatesPlayedToggle_1 = __webpack_require__(/*! ./CandidatesPlayedToggle */ \"./js/rating-calculator/components/CandidatesPlayedToggle.tsx\");\r\nconst ChartRecordsTable_1 = __webpack_require__(/*! ./ChartRecordsTable */ \"./js/rating-calculator/components/ChartRecordsTable.tsx\");\r\nconst CollapsibleContainer_1 = __webpack_require__(/*! ./CollapsibleContainer */ \"./js/rating-calculator/components/CollapsibleContainer.tsx\");\r\nconst CANDIDATE_SONGS_LIMIT = 20;\r\nconst COLUMNS = [\r\n    0 /* NO */,\r\n    1 /* SONG_TITLE */,\r\n    2 /* DIFFICULTY */,\r\n    3 /* LEVEL */,\r\n    4 /* ACHIEVEMENT */,\r\n    6 /* NEXT_RANK */,\r\n    8 /* NEXT_RATING */,\r\n];\r\nconst COMPARATOR = new Map([\r\n    [1 /* SONG_TITLE */, record_comparator_1.compareSongsByName],\r\n    [2 /* DIFFICULTY */, record_comparator_1.compareSongsByDifficulty],\r\n    [3 /* LEVEL */, record_comparator_1.compareSongsByLevel],\r\n    [4 /* ACHIEVEMENT */, record_comparator_1.compareSongsByAchv],\r\n    [6 /* NEXT_RANK */, record_comparator_1.compareSongsByNextRank],\r\n    [8 /* NEXT_RATING */, record_comparator_1.compareSongsByNextRating],\r\n]);\r\nclass CandidateChartRecords extends react_1.default.PureComponent {\r\n    constructor() {\r\n        super(...arguments);\r\n        this.state = { showAll: false, showPlayed: true };\r\n        this.toggleShowMore = (evt) => {\r\n            evt.preventDefault();\r\n            this.setState((state) => ({ showAll: !state.showAll }));\r\n        };\r\n        this.toggleShowNotPlayed = (showPlayed) => {\r\n            this.setState({ showPlayed });\r\n        };\r\n        this.handleSortBy = (col) => {\r\n            this.setState((state) => {\r\n                if (!COMPARATOR.has(col)) {\r\n                    this.setState({ sortBy: undefined });\r\n                }\r\n                else if (col === state.sortBy) {\r\n                    this.setState({ reverse: !state.reverse });\r\n                }\r\n                else {\r\n                    this.setState({ sortBy: col, reverse: false });\r\n                }\r\n            });\r\n        };\r\n    }\r\n    render() {\r\n        const { hidden, records, notPlayed, songPropsByName, name } = this.props;\r\n        const { showAll, showPlayed, sortBy, reverse } = this.state;\r\n        let recordsToShow = showPlayed ? records.slice() : notPlayed.slice();\r\n        const hasMore = recordsToShow.length > CANDIDATE_SONGS_LIMIT;\r\n        if (hasMore && !showAll) {\r\n            recordsToShow = recordsToShow.slice(0, CANDIDATE_SONGS_LIMIT);\r\n        }\r\n        recordsToShow.forEach((r, i) => (r.order = i + 1));\r\n        if (sortBy) {\r\n            recordsToShow.sort(COMPARATOR.get(sortBy));\r\n            if (reverse) {\r\n                recordsToShow.reverse();\r\n            }\r\n        }\r\n        return (react_1.default.createElement(CollapsibleContainer_1.CollapsibleContainer, { className: \"songRecordTableContainer\", hidden: hidden },\r\n            notPlayed && (react_1.default.createElement(CandidatesPlayedToggle_1.CandidatesPlayedToggle, { name: name, showPlayed: showPlayed, toggleShowPlayed: this.toggleShowNotPlayed })),\r\n            react_1.default.createElement(ChartRecordsTable_1.ChartRecordsTable, { songPropsByName: songPropsByName, tableClassname: \"candidateTable\", records: recordsToShow, sortBy: this.handleSortBy, columns: COLUMNS }),\r\n            hasMore && (react_1.default.createElement(\"a\", { className: \"showMore\", href: \"#\", onClick: this.toggleShowMore }, showAll ? i18n_1.UIString.showLess : i18n_1.UIString.showMore))));\r\n    }\r\n}\r\nexports.CandidateChartRecords = CandidateChartRecords;\r\n\n\n//# sourceURL=webpack:///./js/rating-calculator/components/CandidatesChartRecords.tsx?");

/***/ }),

/***/ "./js/rating-calculator/components/CandidatesPlayedToggle.tsx":
/*!********************************************************************!*\
  !*** ./js/rating-calculator/components/CandidatesPlayedToggle.tsx ***!
  \********************************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\r\nvar __importDefault = (this && this.__importDefault) || function (mod) {\r\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\r\n};\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.CandidatesPlayedToggle = void 0;\r\nconst react_1 = __importDefault(__webpack_require__(/*! react */ \"react\"));\r\nconst i18n_1 = __webpack_require__(/*! ../i18n */ \"./js/rating-calculator/i18n.ts\");\r\nclass CandidatesPlayedToggle extends react_1.default.PureComponent {\r\n    constructor() {\r\n        super(...arguments);\r\n        this.handleRadioChange = () => {\r\n            this.props.toggleShowPlayed(!this.props.showPlayed);\r\n        };\r\n    }\r\n    render() {\r\n        const { name, showPlayed } = this.props;\r\n        return (react_1.default.createElement(\"div\", { className: \"w90\" },\r\n            react_1.default.createElement(\"form\", { className: \"playedToggleForm\" },\r\n                react_1.default.createElement(\"label\", { className: \"radioLabel\" },\r\n                    react_1.default.createElement(\"input\", { className: \"radioInput\", name: `showPlayed-${name}`, value: \"1\", type: \"radio\", checked: showPlayed, onChange: this.handleRadioChange }),\r\n                    i18n_1.UIString.showPlayed),\r\n                react_1.default.createElement(\"label\", { className: \"radioLabel\" },\r\n                    react_1.default.createElement(\"input\", { className: \"radioInput\", name: `showPlayed-${name}`, value: \"0\", type: \"radio\", checked: !showPlayed, onChange: this.handleRadioChange }),\r\n                    i18n_1.UIString.showNotPlayed))));\r\n    }\r\n}\r\nexports.CandidatesPlayedToggle = CandidatesPlayedToggle;\r\n\n\n//# sourceURL=webpack:///./js/rating-calculator/components/CandidatesPlayedToggle.tsx?");

/***/ }),

/***/ "./js/rating-calculator/components/ChartRecordDataRow.tsx":
/*!****************************************************************!*\
  !*** ./js/rating-calculator/components/ChartRecordDataRow.tsx ***!
  \****************************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\r\nvar __importDefault = (this && this.__importDefault) || function (mod) {\r\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\r\n};\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.ChartRecordDataRow = void 0;\r\nconst react_1 = __importDefault(__webpack_require__(/*! react */ \"react\"));\r\nconst constants_1 = __webpack_require__(/*! ../../common/constants */ \"./js/common/constants.ts\");\r\nconst rank_functions_1 = __webpack_require__(/*! ../../common/rank-functions */ \"./js/common/rank-functions.ts\");\r\nconst song_util_1 = __webpack_require__(/*! ../../common/song-util */ \"./js/common/song-util.ts\");\r\nconst ChartRecordRow_1 = __webpack_require__(/*! ./ChartRecordRow */ \"./js/rating-calculator/components/ChartRecordRow.tsx\");\r\nfunction getSongNameDisplay(record, songPropsByName) {\r\n    const songPropsArray = songPropsByName.get(record.songName);\r\n    if (songPropsArray && songPropsArray.length > 1) {\r\n        return song_util_1.getSongNickname(record.songName, record.genre, record.chartType === 1 /* DX */);\r\n    }\r\n    return record.songName;\r\n}\r\nexports.ChartRecordDataRow = react_1.default.memo((props) => {\r\n    const { record, index, columns, songPropsByName } = props;\r\n    const columnValues = columns.map((c) => {\r\n        switch (c) {\r\n            case 0 /* NO */:\r\n                return index;\r\n            case 1 /* SONG_TITLE */:\r\n                return getSongNameDisplay(record, songPropsByName);\r\n            case 2 /* DIFFICULTY */:\r\n                return record.difficulty;\r\n            case 3 /* LEVEL */:\r\n                const lvText = record.level.toFixed(1);\r\n                return record.levelIsEstimate ? \"*\" + lvText : lvText;\r\n            case 4 /* ACHIEVEMENT */:\r\n                return record.achievement.toFixed(4) + \"%\";\r\n            case 5 /* RANK */:\r\n                return rank_functions_1.getRankTitle(record.achievement);\r\n            case 6 /* NEXT_RANK */:\r\n                return Array.from(record.nextRanks.values())\r\n                    .map((r) => r.rank.th + \"%\")\r\n                    .join(\"\\n\");\r\n            case 8 /* NEXT_RATING */:\r\n                return Array.from(record.nextRanks.values())\r\n                    .map((r) => \"+\" + r.minRt.toFixed(0))\r\n                    .join(\"\\n\");\r\n            case 7 /* RATING */:\r\n                return Math.floor(record.rating).toString();\r\n        }\r\n    });\r\n    return (react_1.default.createElement(ChartRecordRow_1.ChartRecordRow, { className: constants_1.DIFFICULTY_CLASSNAME_MAP.get(record.difficulty), columnValues: columnValues }));\r\n});\r\n\n\n//# sourceURL=webpack:///./js/rating-calculator/components/ChartRecordDataRow.tsx?");

/***/ }),

/***/ "./js/rating-calculator/components/ChartRecordHeadRow.tsx":
/*!****************************************************************!*\
  !*** ./js/rating-calculator/components/ChartRecordHeadRow.tsx ***!
  \****************************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\r\nvar __importDefault = (this && this.__importDefault) || function (mod) {\r\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\r\n};\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.ChartRecordHeadRow = void 0;\r\nconst react_1 = __importDefault(__webpack_require__(/*! react */ \"react\"));\r\nconst i18n_1 = __webpack_require__(/*! ../i18n */ \"./js/rating-calculator/i18n.ts\");\r\nconst ChartRecordRow_1 = __webpack_require__(/*! ./ChartRecordRow */ \"./js/rating-calculator/components/ChartRecordRow.tsx\");\r\nconst COLUMN_TITLE = {\r\n    [0 /* NO */]: i18n_1.UIString.num,\r\n    [1 /* SONG_TITLE */]: i18n_1.UIString.song,\r\n    [2 /* DIFFICULTY */]: i18n_1.UIString.difficulty,\r\n    [3 /* LEVEL */]: i18n_1.UIString.level,\r\n    [4 /* ACHIEVEMENT */]: i18n_1.UIString.achievementAbbr,\r\n    [5 /* RANK */]: i18n_1.UIString.rank,\r\n    [7 /* RATING */]: i18n_1.UIString.rating,\r\n    [6 /* NEXT_RANK */]: i18n_1.UIString.nextGoal,\r\n    [8 /* NEXT_RATING */]: i18n_1.UIString.nextRating,\r\n};\r\nexports.ChartRecordHeadRow = react_1.default.memo(({ columns, sortBy }) => {\r\n    const columnTitles = columns.map(c => COLUMN_TITLE[c]);\r\n    const handleClick = sortBy && ((index) => sortBy(columns[index]));\r\n    return react_1.default.createElement(ChartRecordRow_1.ChartRecordRow, { columnValues: columnTitles, onClickCell: handleClick, isHeading: true });\r\n});\r\n\n\n//# sourceURL=webpack:///./js/rating-calculator/components/ChartRecordHeadRow.tsx?");

/***/ }),

/***/ "./js/rating-calculator/components/ChartRecordRow.tsx":
/*!************************************************************!*\
  !*** ./js/rating-calculator/components/ChartRecordRow.tsx ***!
  \************************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\r\nvar __importDefault = (this && this.__importDefault) || function (mod) {\r\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\r\n};\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.ChartRecordRow = void 0;\r\nconst react_1 = __importDefault(__webpack_require__(/*! react */ \"react\"));\r\nconst wiki_link_1 = __webpack_require__(/*! ../../common/wiki-link */ \"./js/common/wiki-link.ts\");\r\nconst SCORE_RECORD_ROW_CLASSNAME = \"scoreRecordRow\";\r\nconst SCORE_RECORD_CELL_BASE_CLASSNAME = \"scoreRecordCell\";\r\nconst ACHV_CELL_CLASSNAME = \"achievementCell\";\r\nconst SCORE_RECORD_CELL_CLASSNAMES = [\r\n    \"orderCell\",\r\n    \"songTitleCell\",\r\n    \"difficultyCell\",\r\n    \"levelCell\",\r\n    ACHV_CELL_CLASSNAME,\r\n    \"rankCell\",\r\n    \"ratingCell\",\r\n];\r\nclass ChartRecordRow extends react_1.default.PureComponent {\r\n    constructor() {\r\n        super(...arguments);\r\n        this.getChildren = (value, colIdx) => {\r\n            if (colIdx === 1) {\r\n                // song title\r\n                return (react_1.default.createElement(react_1.default.Fragment, null,\r\n                    react_1.default.createElement(\"a\", { className: \"songWikiLink\", href: wiki_link_1.getZhWikiLink(value), target: \"_blank\" }, value)));\r\n            }\r\n            if (typeof value === \"string\" && value.includes(\"\\n\")) {\r\n                return value.split(\"\\n\").map((v, idx) => react_1.default.createElement(\"div\", { key: idx }, v));\r\n            }\r\n            return value;\r\n        };\r\n    }\r\n    render() {\r\n        const { columnValues, isHeading, onClickCell } = this.props;\r\n        let className = SCORE_RECORD_ROW_CLASSNAME;\r\n        if (this.props.className) {\r\n            className += \" \" + this.props.className;\r\n        }\r\n        return (react_1.default.createElement(\"tr\", { className: className }, columnValues.map((v, index) => {\r\n            const columnClassName = SCORE_RECORD_CELL_CLASSNAMES[index];\r\n            let className = SCORE_RECORD_CELL_BASE_CLASSNAME + \" \" + columnClassName;\r\n            const children = this.getChildren(v, index);\r\n            const clickProps = onClickCell ? { tabIndex: 0, onClick: () => onClickCell(index) } : {};\r\n            if (isHeading) {\r\n                return (react_1.default.createElement(\"th\", Object.assign({ className: className }, clickProps), children));\r\n            }\r\n            return (react_1.default.createElement(\"td\", Object.assign({ className: className }, clickProps), children));\r\n        })));\r\n    }\r\n}\r\nexports.ChartRecordRow = ChartRecordRow;\r\n\n\n//# sourceURL=webpack:///./js/rating-calculator/components/ChartRecordRow.tsx?");

/***/ }),

/***/ "./js/rating-calculator/components/ChartRecordSectionTitle.tsx":
/*!*********************************************************************!*\
  !*** ./js/rating-calculator/components/ChartRecordSectionTitle.tsx ***!
  \*********************************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\r\nvar __importDefault = (this && this.__importDefault) || function (mod) {\r\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\r\n};\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.ChartRecordSectionTitle = void 0;\r\nconst react_1 = __importDefault(__webpack_require__(/*! react */ \"react\"));\r\nclass ChartRecordSectionTitle extends react_1.default.PureComponent {\r\n    constructor() {\r\n        super(...arguments);\r\n        this.state = { symbolClassName: \"\" };\r\n        this.handleClick = (evt) => {\r\n            evt.preventDefault();\r\n            this.props.onClick(evt);\r\n        };\r\n        this.handleKeyPress = (evt) => {\r\n            evt.preventDefault();\r\n            console.log(evt.key);\r\n            console.log(evt.keyCode);\r\n            if (evt.key === \"Enter\") {\r\n                this.props.onClick(evt);\r\n            }\r\n        };\r\n    }\r\n    componentDidUpdate(prevProps) {\r\n        if (prevProps.contentHidden && !this.props.contentHidden) {\r\n            this.setState({ symbolClassName: \"crSecShow\" });\r\n            window.setTimeout(() => {\r\n                this.setState({ symbolClassName: \"\" });\r\n            }, 300);\r\n        }\r\n    }\r\n    render() {\r\n        const { isCandidateList, contentHidden, title } = this.props;\r\n        let { symbolClassName } = this.state;\r\n        const symbol = isCandidateList ? \"▶\" : \"▷\";\r\n        symbolClassName += \" crSecTitleSymbol\";\r\n        if (contentHidden) {\r\n            symbolClassName += \" crSecHidden\";\r\n        }\r\n        return (react_1.default.createElement(\"h3\", { className: \"crSecTitleContainer\" },\r\n            react_1.default.createElement(\"span\", { className: \"crSecTitle\", tabIndex: 0, onClick: this.handleClick, onKeyPress: this.handleKeyPress },\r\n                react_1.default.createElement(\"span\", { className: symbolClassName }, symbol),\r\n                title)));\r\n    }\r\n}\r\nexports.ChartRecordSectionTitle = ChartRecordSectionTitle;\r\n\n\n//# sourceURL=webpack:///./js/rating-calculator/components/ChartRecordSectionTitle.tsx?");

/***/ }),

/***/ "./js/rating-calculator/components/ChartRecordsTable.tsx":
/*!***************************************************************!*\
  !*** ./js/rating-calculator/components/ChartRecordsTable.tsx ***!
  \***************************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\r\nvar __importDefault = (this && this.__importDefault) || function (mod) {\r\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\r\n};\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.ChartRecordsTable = void 0;\r\nconst react_1 = __importDefault(__webpack_require__(/*! react */ \"react\"));\r\nconst ChartRecordDataRow_1 = __webpack_require__(/*! ./ChartRecordDataRow */ \"./js/rating-calculator/components/ChartRecordDataRow.tsx\");\r\nconst ChartRecordHeadRow_1 = __webpack_require__(/*! ./ChartRecordHeadRow */ \"./js/rating-calculator/components/ChartRecordHeadRow.tsx\");\r\nclass ChartRecordsTable extends react_1.default.PureComponent {\r\n    render() {\r\n        const { columns, sortBy, records, songPropsByName } = this.props;\r\n        let { tableClassname } = this.props;\r\n        tableClassname += \" songRecordTable\";\r\n        return (react_1.default.createElement(\"table\", { className: tableClassname },\r\n            react_1.default.createElement(\"thead\", null,\r\n                react_1.default.createElement(ChartRecordHeadRow_1.ChartRecordHeadRow, { sortBy: sortBy, columns: columns })),\r\n            react_1.default.createElement(\"tbody\", null, records.map((r, index) => {\r\n                index = r.order || index + 1;\r\n                return (react_1.default.createElement(ChartRecordDataRow_1.ChartRecordDataRow, { songPropsByName: songPropsByName, record: r, columns: columns, index: index }));\r\n            }))));\r\n    }\r\n}\r\nexports.ChartRecordsTable = ChartRecordsTable;\r\n\n\n//# sourceURL=webpack:///./js/rating-calculator/components/ChartRecordsTable.tsx?");

/***/ }),

/***/ "./js/rating-calculator/components/CollapsibleContainer.tsx":
/*!******************************************************************!*\
  !*** ./js/rating-calculator/components/CollapsibleContainer.tsx ***!
  \******************************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\r\nvar __importDefault = (this && this.__importDefault) || function (mod) {\r\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\r\n};\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.CollapsibleContainer = void 0;\r\nconst react_1 = __importDefault(__webpack_require__(/*! react */ \"react\"));\r\nclass CollapsibleContainer extends react_1.default.PureComponent {\r\n    render() {\r\n        let className = \"collapsibleContainer\";\r\n        if (this.props.className) {\r\n            className += \" \" + this.props.className;\r\n        }\r\n        if (this.props.hidden) {\r\n            className += \" hidden\";\r\n        }\r\n        return (react_1.default.createElement(\"div\", { className: className }, this.props.children));\r\n    }\r\n}\r\nexports.CollapsibleContainer = CollapsibleContainer;\r\n\n\n//# sourceURL=webpack:///./js/rating-calculator/components/CollapsibleContainer.tsx?");

/***/ }),

/***/ "./js/rating-calculator/components/DifficultyDistribution.tsx":
/*!********************************************************************!*\
  !*** ./js/rating-calculator/components/DifficultyDistribution.tsx ***!
  \********************************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\r\nvar __importDefault = (this && this.__importDefault) || function (mod) {\r\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\r\n};\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.DifficultyDistribution = void 0;\r\nconst react_1 = __importDefault(__webpack_require__(/*! react */ \"react\"));\r\nconst constants_1 = __webpack_require__(/*! ../../common/constants */ \"./js/common/constants.ts\");\r\nconst i18n_1 = __webpack_require__(/*! ../i18n */ \"./js/rating-calculator/i18n.ts\");\r\nconst RankDistributionDataRow_1 = __webpack_require__(/*! ./RankDistributionDataRow */ \"./js/rating-calculator/components/RankDistributionDataRow.tsx\");\r\nconst RankDistributionHeadRow_1 = __webpack_require__(/*! ./RankDistributionHeadRow */ \"./js/rating-calculator/components/RankDistributionHeadRow.tsx\");\r\nconst DIFF_RANK_CELL_BASE_CLASSNAME = \"diffRankCell\";\r\nconst DIFF_RANK_TOP_LEFT_CELL_CLASSNAME = \"difficultyRankDistHead\";\r\nfunction getRecordsPerDifficulty(records) {\r\n    const recordsPerDifficulty = new Map();\r\n    for (let i = constants_1.DIFFICULTIES.length - 1; i >= 0; i--) {\r\n        recordsPerDifficulty.set(constants_1.DIFFICULTIES[i], []);\r\n    }\r\n    for (const r of records) {\r\n        recordsPerDifficulty.get(r.difficulty).push(r);\r\n    }\r\n    return recordsPerDifficulty;\r\n}\r\nclass DifficultyDistribution extends react_1.default.PureComponent {\r\n    render() {\r\n        const { chartRecords, topChartsCount } = this.props;\r\n        const topRecords = chartRecords.slice(0, topChartsCount);\r\n        const recordsPerDiff = getRecordsPerDifficulty(topRecords);\r\n        const keyMap = new Map([[i18n_1.UIString.subtotal, true]]);\r\n        return (react_1.default.createElement(\"table\", { className: \"rankDistributionTable\" },\r\n            react_1.default.createElement(\"thead\", null,\r\n                react_1.default.createElement(RankDistributionHeadRow_1.RankDistributionHeadRow, { firstCell: i18n_1.UIString.difficulty, baseCellClassname: DIFF_RANK_CELL_BASE_CLASSNAME, perColumnClassnames: [DIFF_RANK_TOP_LEFT_CELL_CLASSNAME], columns: keyMap.keys() })),\r\n            react_1.default.createElement(\"tbody\", null, Array.from(recordsPerDiff.entries()).map(([d, records]) => {\r\n                if (!records.length) {\r\n                    return;\r\n                }\r\n                const dist = new Map([\r\n                    [i18n_1.UIString.subtotal, records.length],\r\n                ]);\r\n                return (react_1.default.createElement(RankDistributionDataRow_1.RankDistributionDataRow, { key: d, rowHead: d, columns: keyMap.keys(), rankDist: dist, rowClassname: constants_1.DIFFICULTY_CLASSNAME_MAP.get(d), baseCellClassname: DIFF_RANK_CELL_BASE_CLASSNAME, perColumnClassnames: [] }));\r\n            }))));\r\n    }\r\n}\r\nexports.DifficultyDistribution = DifficultyDistribution;\r\n\n\n//# sourceURL=webpack:///./js/rating-calculator/components/DifficultyDistribution.tsx?");

/***/ }),

/***/ "./js/rating-calculator/components/InternalLvInput.tsx":
/*!*************************************************************!*\
  !*** ./js/rating-calculator/components/InternalLvInput.tsx ***!
  \*************************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\r\nvar __importDefault = (this && this.__importDefault) || function (mod) {\r\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\r\n};\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.InternalLvInput = void 0;\r\nconst react_1 = __importDefault(__webpack_require__(/*! react */ \"react\"));\r\nconst i18n_1 = __webpack_require__(/*! ../i18n */ \"./js/rating-calculator/i18n.ts\");\r\nclass InternalLvInput extends react_1.default.PureComponent {\r\n    constructor() {\r\n        super(...arguments);\r\n        this.state = { showTextarea: false };\r\n        this.textareaRef = react_1.default.createRef();\r\n        this.handleRadioChange = (evt) => {\r\n            this.setState({ showTextarea: evt.currentTarget.value === \"1\" });\r\n        };\r\n    }\r\n    render() {\r\n        const { showTextarea } = this.state;\r\n        return (react_1.default.createElement(\"div\", { className: \"w90\" },\r\n            react_1.default.createElement(\"h2\", { className: \"lvInputHeading\" }, i18n_1.UIString.internalLvHeading),\r\n            react_1.default.createElement(\"form\", null,\r\n                react_1.default.createElement(\"label\", { className: \"radioLabel\" },\r\n                    react_1.default.createElement(\"input\", { className: \"radioInput\", name: \"showLvInput\", value: \"0\", type: \"radio\", checked: !showTextarea, onChange: this.handleRadioChange }),\r\n                    i18n_1.UIString.autoLv),\r\n                react_1.default.createElement(\"label\", { className: \"radioLabel\" },\r\n                    react_1.default.createElement(\"input\", { className: \"radioInput\", name: \"showLvInput\", value: \"1\", type: \"radio\", checked: showTextarea, onChange: this.handleRadioChange }),\r\n                    i18n_1.UIString.manualLv)),\r\n            showTextarea && react_1.default.createElement(\"textarea\", { className: \"lvInput\", ref: this.textareaRef })));\r\n    }\r\n    getInput() {\r\n        if (this.textareaRef.current) {\r\n            return this.textareaRef.current.value;\r\n        }\r\n        return \"\";\r\n    }\r\n}\r\nexports.InternalLvInput = InternalLvInput;\r\n\n\n//# sourceURL=webpack:///./js/rating-calculator/components/InternalLvInput.tsx?");

/***/ }),

/***/ "./js/rating-calculator/components/LevelRankDistribution.tsx":
/*!*******************************************************************!*\
  !*** ./js/rating-calculator/components/LevelRankDistribution.tsx ***!
  \*******************************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\r\nvar __importDefault = (this && this.__importDefault) || function (mod) {\r\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\r\n};\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.LevelRankDistribution = void 0;\r\nconst react_1 = __importDefault(__webpack_require__(/*! react */ \"react\"));\r\nconst level_helper_1 = __webpack_require__(/*! ../../common/level-helper */ \"./js/common/level-helper.ts\");\r\nconst number_helper_1 = __webpack_require__(/*! ../../common/number-helper */ \"./js/common/number-helper.ts\");\r\nconst rank_distribution_1 = __webpack_require__(/*! ../rank-distribution */ \"./js/rating-calculator/rank-distribution.tsx\");\r\nconst RankDistributionDataRow_1 = __webpack_require__(/*! ./RankDistributionDataRow */ \"./js/rating-calculator/components/RankDistributionDataRow.tsx\");\r\nconst RankDistributionHeadRow_1 = __webpack_require__(/*! ./RankDistributionHeadRow */ \"./js/rating-calculator/components/RankDistributionHeadRow.tsx\");\r\nconst LEVEL_RANK_CELL_BASE_CLASSNAME = \"levelRankCell\";\r\nconst LEVEL_RANK_CELL_CLASSNAMES = [\"officialLevelCell\"];\r\nfunction getRecordsPerLevel(records) {\r\n    const levels = records.map((r) => r.level);\r\n    levels.sort(number_helper_1.compareNumber);\r\n    levels.reverse();\r\n    const recordsPerLevel = new Map();\r\n    for (const lv of levels) {\r\n        const officialLv = level_helper_1.getOfficialLevel(lv);\r\n        if (!recordsPerLevel.has(officialLv)) {\r\n            recordsPerLevel.set(officialLv, []);\r\n        }\r\n    }\r\n    for (const r of records) {\r\n        recordsPerLevel.get(level_helper_1.getOfficialLevel(r.level)).push(r);\r\n    }\r\n    return recordsPerLevel;\r\n}\r\nclass LevelRankDistribution extends react_1.default.PureComponent {\r\n    render() {\r\n        const { chartRecords, topLeftCell, topChartsCount } = this.props;\r\n        const topRecords = chartRecords.slice(0, topChartsCount);\r\n        const rankMap = rank_distribution_1.getRankMap(topRecords);\r\n        const recordsPerLevel = getRecordsPerLevel(topRecords);\r\n        return (react_1.default.createElement(\"table\", { className: \"rankDistributionTable\" },\r\n            react_1.default.createElement(\"thead\", null,\r\n                react_1.default.createElement(RankDistributionHeadRow_1.RankDistributionHeadRow, { columns: rankMap.keys(), firstCell: topLeftCell, baseCellClassname: LEVEL_RANK_CELL_BASE_CLASSNAME, perColumnClassnames: LEVEL_RANK_CELL_CLASSNAMES })),\r\n            react_1.default.createElement(\"tbody\", null, Array.from(recordsPerLevel.entries()).map(([level, records]) => (react_1.default.createElement(RankDistributionDataRow_1.RankDistributionDataRow, { key: level, rowHead: level, columns: rankMap.keys(), rankDist: rank_distribution_1.getRankDistribution(records), baseCellClassname: LEVEL_RANK_CELL_BASE_CLASSNAME, perColumnClassnames: LEVEL_RANK_CELL_CLASSNAMES }))))));\r\n    }\r\n}\r\nexports.LevelRankDistribution = LevelRankDistribution;\r\n\n\n//# sourceURL=webpack:///./js/rating-calculator/components/LevelRankDistribution.tsx?");

/***/ }),

/***/ "./js/rating-calculator/components/MultiplierTable.tsx":
/*!*************************************************************!*\
  !*** ./js/rating-calculator/components/MultiplierTable.tsx ***!
  \*************************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\r\nvar __importDefault = (this && this.__importDefault) || function (mod) {\r\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\r\n};\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.MultiplierTable = void 0;\r\nconst react_1 = __importDefault(__webpack_require__(/*! react */ \"react\"));\r\nconst rank_functions_1 = __webpack_require__(/*! ../../common/rank-functions */ \"./js/common/rank-functions.ts\");\r\nconst i18n_1 = __webpack_require__(/*! ../i18n */ \"./js/rating-calculator/i18n.ts\");\r\nconst MIN_RANK_OPTION = \"A\";\r\nconst RANK_FACTOR_CELL_BASE_CLASSNAME = \"qlRankFactorCell\";\r\nconst RANK_FACTOR_CELL_CLASSNAMES = [\"qlRankTitleCell\", \"qlThresholdCell\"];\r\nconst RankFactorRow = (props) => {\r\n    const { isHeading } = props;\r\n    return (react_1.default.createElement(\"tr\", null, props.values.map((v, index) => {\r\n        const useTh = isHeading || index === 0;\r\n        let className = RANK_FACTOR_CELL_BASE_CLASSNAME;\r\n        if (index < RANK_FACTOR_CELL_CLASSNAMES.length) {\r\n            className += \" \" + RANK_FACTOR_CELL_CLASSNAMES[index];\r\n        }\r\n        return useTh ? react_1.default.createElement(\"th\", { className: className }, v) : react_1.default.createElement(\"td\", { className: className }, v);\r\n    })));\r\n};\r\nclass MultiplierTable extends react_1.default.PureComponent {\r\n    constructor() {\r\n        super(...arguments);\r\n        this.state = { minRankOption: MIN_RANK_OPTION };\r\n    }\r\n    render() {\r\n        const { minRankOption } = this.state;\r\n        const rankDefs = rank_functions_1.RANK_DEFINITIONS;\r\n        const stopIndex = rankDefs.findIndex((r) => r.title === minRankOption) + 1;\r\n        return (react_1.default.createElement(\"div\", { className: \"quickLookup\" },\r\n            react_1.default.createElement(\"h2\", { className: \"quickLookupHeading\" }, i18n_1.UIString.rankFactorTable),\r\n            react_1.default.createElement(\"table\", { className: \"quickLookupTable\" },\r\n                react_1.default.createElement(\"thead\", null,\r\n                    react_1.default.createElement(RankFactorRow, { values: [i18n_1.UIString.rank, i18n_1.UIString.achievement, i18n_1.UIString.factor, i18n_1.UIString.multiplier], isHeading: true })),\r\n                react_1.default.createElement(\"tbody\", null, rankDefs.slice(0, stopIndex).map((r, idx, arr) => {\r\n                    const minMultiplier = (r.th * r.factor) / 100;\r\n                    const maxMultiplier = idx > 0 ? ((arr[idx - 1].th - 0.0001) * r.factor) / 100 : minMultiplier;\r\n                    const minMulText = minMultiplier.toFixed(3);\r\n                    const maxMulText = maxMultiplier.toFixed(3);\r\n                    const multiplierRange = minMulText !== maxMulText ? `${minMulText} - ${maxMulText}` : minMulText;\r\n                    return react_1.default.createElement(RankFactorRow, { values: [r.title, r.th, r.factor, multiplierRange] });\r\n                }))),\r\n            react_1.default.createElement(\"hr\", { className: \"sectionSep\" })));\r\n    }\r\n}\r\nexports.MultiplierTable = MultiplierTable;\r\n\n\n//# sourceURL=webpack:///./js/rating-calculator/components/MultiplierTable.tsx?");

/***/ }),

/***/ "./js/rating-calculator/components/OtherTools.tsx":
/*!********************************************************!*\
  !*** ./js/rating-calculator/components/OtherTools.tsx ***!
  \********************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\r\nvar __importDefault = (this && this.__importDefault) || function (mod) {\r\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\r\n};\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.OtherTools = void 0;\r\nconst react_1 = __importDefault(__webpack_require__(/*! react */ \"react\"));\r\nconst i18n_1 = __webpack_require__(/*! ../i18n */ \"./js/rating-calculator/i18n.ts\");\r\nclass OtherTools extends react_1.default.PureComponent {\r\n    render() {\r\n        return (react_1.default.createElement(\"div\", { className: \"otherToolsContainer\" },\r\n            react_1.default.createElement(\"h2\", { className: \"otherToolsHeading\" }, i18n_1.UIString.otherToolsHeading),\r\n            react_1.default.createElement(\"ul\", null,\r\n                react_1.default.createElement(\"li\", { className: \"toolItem\" },\r\n                    react_1.default.createElement(\"a\", { href: \"../rating-visualizer/\" }, i18n_1.UIString.ratingVisualizer)),\r\n                react_1.default.createElement(\"li\", { className: \"toolItem\" },\r\n                    react_1.default.createElement(\"a\", { href: \"../bookmarklets/\" }, i18n_1.UIString.bookmarketList))),\r\n            react_1.default.createElement(\"hr\", { className: \"sectionSep\" })));\r\n    }\r\n}\r\nexports.OtherTools = OtherTools;\r\n\n\n//# sourceURL=webpack:///./js/rating-calculator/components/OtherTools.tsx?");

/***/ }),

/***/ "./js/rating-calculator/components/PageFooter.tsx":
/*!********************************************************!*\
  !*** ./js/rating-calculator/components/PageFooter.tsx ***!
  \********************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\r\nvar __importDefault = (this && this.__importDefault) || function (mod) {\r\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\r\n};\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.PageFooter = void 0;\r\nconst react_1 = __importDefault(__webpack_require__(/*! react */ \"react\"));\r\nclass PageFooter extends react_1.default.PureComponent {\r\n    render() {\r\n        return (react_1.default.createElement(\"footer\", null,\r\n            \"Made by\",\r\n            \" \",\r\n            react_1.default.createElement(\"a\", { className: \"authorLink\", href: \"https://github.com/myjian/\" }, \"myjian\"),\r\n            \".\"));\r\n    }\r\n}\r\nexports.PageFooter = PageFooter;\r\n\n\n//# sourceURL=webpack:///./js/rating-calculator/components/PageFooter.tsx?");

/***/ }),

/***/ "./js/rating-calculator/components/RankDistributionDataRow.tsx":
/*!*********************************************************************!*\
  !*** ./js/rating-calculator/components/RankDistributionDataRow.tsx ***!
  \*********************************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\r\nvar __importDefault = (this && this.__importDefault) || function (mod) {\r\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\r\n};\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.RankDistributionDataRow = void 0;\r\nconst react_1 = __importDefault(__webpack_require__(/*! react */ \"react\"));\r\nconst RankDistributionRow_1 = __webpack_require__(/*! ./RankDistributionRow */ \"./js/rating-calculator/components/RankDistributionRow.tsx\");\r\nexports.RankDistributionDataRow = react_1.default.memo((props) => {\r\n    const values = [props.rowHead];\r\n    let totalCount = 0;\r\n    for (const key of props.columns) {\r\n        const count = props.rankDist.get(key);\r\n        values.push(count || \"-\");\r\n        totalCount += count;\r\n    }\r\n    if (props.showTotal) {\r\n        values.push(totalCount);\r\n    }\r\n    return (react_1.default.createElement(RankDistributionRow_1.RankDistributionRow, { values: values, showTotal: props.showTotal, rowClassname: props.rowClassname, baseCellClassname: props.baseCellClassname, perColumnClassnames: props.perColumnClassnames }));\r\n});\r\n\n\n//# sourceURL=webpack:///./js/rating-calculator/components/RankDistributionDataRow.tsx?");

/***/ }),

/***/ "./js/rating-calculator/components/RankDistributionHeadRow.tsx":
/*!*********************************************************************!*\
  !*** ./js/rating-calculator/components/RankDistributionHeadRow.tsx ***!
  \*********************************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\r\nvar __importDefault = (this && this.__importDefault) || function (mod) {\r\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\r\n};\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.RankDistributionHeadRow = void 0;\r\nconst react_1 = __importDefault(__webpack_require__(/*! react */ \"react\"));\r\nconst i18n_1 = __webpack_require__(/*! ../i18n */ \"./js/rating-calculator/i18n.ts\");\r\nconst RankDistributionRow_1 = __webpack_require__(/*! ./RankDistributionRow */ \"./js/rating-calculator/components/RankDistributionRow.tsx\");\r\nclass RankDistributionHeadRow extends react_1.default.PureComponent {\r\n    render() {\r\n        const { firstCell, columns, showTotal, baseCellClassname, perColumnClassnames } = this.props;\r\n        const values = [firstCell];\r\n        for (const key of columns) {\r\n            values.push(key);\r\n        }\r\n        if (showTotal) {\r\n            values.push(i18n_1.UIString.subtotal);\r\n        }\r\n        return (react_1.default.createElement(RankDistributionRow_1.RankDistributionRow, { values: values, isHeading: true, showTotal: showTotal, baseCellClassname: baseCellClassname, perColumnClassnames: perColumnClassnames }));\r\n    }\r\n}\r\nexports.RankDistributionHeadRow = RankDistributionHeadRow;\r\n\n\n//# sourceURL=webpack:///./js/rating-calculator/components/RankDistributionHeadRow.tsx?");

/***/ }),

/***/ "./js/rating-calculator/components/RankDistributionRow.tsx":
/*!*****************************************************************!*\
  !*** ./js/rating-calculator/components/RankDistributionRow.tsx ***!
  \*****************************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\r\nvar __importDefault = (this && this.__importDefault) || function (mod) {\r\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\r\n};\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.RankDistributionRow = void 0;\r\nconst react_1 = __importDefault(__webpack_require__(/*! react */ \"react\"));\r\nconst LAST_CELL_CLASSNAME = \"totalCell\";\r\nclass RankDistributionRow extends react_1.default.PureComponent {\r\n    render() {\r\n        const { values, isHeading, showTotal, rowClassname, baseCellClassname, perColumnClassnames, } = this.props;\r\n        return (react_1.default.createElement(\"tr\", { className: rowClassname }, values.map((v, index) => {\r\n            const useTh = isHeading || index === 0;\r\n            let className = baseCellClassname;\r\n            if (perColumnClassnames[index]) {\r\n                className += \" \" + perColumnClassnames[index];\r\n            }\r\n            if (showTotal && index === values.length - 1) {\r\n                className += \" \" + LAST_CELL_CLASSNAME;\r\n            }\r\n            if (useTh) {\r\n                return react_1.default.createElement(\"th\", { className: className }, v);\r\n            }\r\n            return react_1.default.createElement(\"td\", { className: className }, v);\r\n        })));\r\n    }\r\n}\r\nexports.RankDistributionRow = RankDistributionRow;\r\n\n\n//# sourceURL=webpack:///./js/rating-calculator/components/RankDistributionRow.tsx?");

/***/ }),

/***/ "./js/rating-calculator/components/RatingOutput.tsx":
/*!**********************************************************!*\
  !*** ./js/rating-calculator/components/RatingOutput.tsx ***!
  \**********************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\r\nvar __importDefault = (this && this.__importDefault) || function (mod) {\r\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\r\n};\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.RatingOutput = void 0;\r\nconst react_1 = __importDefault(__webpack_require__(/*! react */ \"react\"));\r\nconst candidate_songs_1 = __webpack_require__(/*! ../candidate-songs */ \"./js/rating-calculator/candidate-songs.ts\");\r\nconst i18n_1 = __webpack_require__(/*! ../i18n */ \"./js/rating-calculator/i18n.ts\");\r\nconst CandidatesChartRecords_1 = __webpack_require__(/*! ./CandidatesChartRecords */ \"./js/rating-calculator/components/CandidatesChartRecords.tsx\");\r\nconst ChartRecordSectionTitle_1 = __webpack_require__(/*! ./ChartRecordSectionTitle */ \"./js/rating-calculator/components/ChartRecordSectionTitle.tsx\");\r\nconst RatingOverview_1 = __webpack_require__(/*! ./RatingOverview */ \"./js/rating-calculator/components/RatingOverview.tsx\");\r\nconst RecommendedLevels_1 = __webpack_require__(/*! ./RecommendedLevels */ \"./js/rating-calculator/components/RecommendedLevels.tsx\");\r\nconst TopChartRecords_1 = __webpack_require__(/*! ./TopChartRecords */ \"./js/rating-calculator/components/TopChartRecords.tsx\");\r\nconst NEW_CANDIDATE_SONGS_POOL_SIZE = 40;\r\nconst OLD_CANDIDATE_SONGS_POOL_SIZE = 60;\r\nclass RatingOutput extends react_1.default.PureComponent {\r\n    constructor() {\r\n        super(...arguments);\r\n        this.outputArea = react_1.default.createRef();\r\n        this.state = {\r\n            hideNewTopSongs: false,\r\n            hideOldTopSongs: false,\r\n            hideNewCandidateSongs: false,\r\n            hideOldCandidateSongs: false,\r\n        };\r\n        this.toggleNewTopChartsDisplay = () => {\r\n            this.setState((state) => ({ hideNewTopSongs: !state.hideNewTopSongs }));\r\n        };\r\n        this.toggleNewCandidateChartsDisplay = () => {\r\n            this.setState((state) => ({ hideNewCandidateSongs: !state.hideNewCandidateSongs }));\r\n        };\r\n        this.toggleOldTopChartsDisplay = () => {\r\n            this.setState((state) => ({ hideOldTopSongs: !state.hideOldTopSongs }));\r\n        };\r\n        this.toggleOldCandidateChartsDisplay = () => {\r\n            this.setState((state) => ({ hideOldCandidateSongs: !state.hideOldCandidateSongs }));\r\n        };\r\n    }\r\n    componentDidMount() {\r\n        if (this.outputArea.current) {\r\n            this.outputArea.current.scrollIntoView({ behavior: \"smooth\" });\r\n        }\r\n    }\r\n    componentDidUpdate(prevProps) {\r\n        if (!prevProps.newSongs && !prevProps.oldSongs && this.props.newSongs && this.props.oldSongs) {\r\n            console.log(this.props.newSongs);\r\n            console.log(this.props.oldSongs);\r\n        }\r\n    }\r\n    render() {\r\n        const { newSongs, oldSongs, playerName, playerGradeIndex, songPropsByName } = this.props;\r\n        const { newChartRecords, newChartsRating, newTopChartsCount, oldChartRecords, oldChartsRating, oldTopChartsCount, } = this.props.ratingData;\r\n        const { hideNewCandidateSongs, hideNewTopSongs, hideOldCandidateSongs, hideOldTopSongs, } = this.state;\r\n        const newChartCandidates = candidate_songs_1.getCandidateSongs(newChartRecords, newTopChartsCount, NEW_CANDIDATE_SONGS_POOL_SIZE);\r\n        const notPlayedNewCharts = newSongs\r\n            ? candidate_songs_1.getNotPlayedCharts(newSongs, newChartRecords, newTopChartsCount, NEW_CANDIDATE_SONGS_POOL_SIZE)\r\n            : [];\r\n        console.log(notPlayedNewCharts);\r\n        const oldChartCandidates = candidate_songs_1.getCandidateSongs(oldChartRecords, oldTopChartsCount, OLD_CANDIDATE_SONGS_POOL_SIZE);\r\n        const notPlayedOldCharts = oldSongs\r\n            ? candidate_songs_1.getNotPlayedCharts(oldSongs, oldChartRecords, oldTopChartsCount, OLD_CANDIDATE_SONGS_POOL_SIZE)\r\n            : [];\r\n        console.log(notPlayedOldCharts);\r\n        return (react_1.default.createElement(\"div\", { className: \"outputArea\", ref: this.outputArea },\r\n            react_1.default.createElement(\"h2\", { id: \"outputHeading\" },\r\n                i18n_1.UIString.analysisResult,\r\n                playerName ? ` - ${playerName}` : null),\r\n            react_1.default.createElement(RatingOverview_1.RatingOverview, { newChartsRating: newChartsRating, newTopChartsCount: newTopChartsCount, oldChartsRating: oldChartsRating, oldTopChartsCount: oldTopChartsCount, playerGradeIndex: playerGradeIndex }),\r\n            react_1.default.createElement(RecommendedLevels_1.RecommendedLevels, { newChartsRating: newChartsRating, newTopChartsCount: newTopChartsCount, oldChartsRating: oldChartsRating, oldTopChartsCount: oldTopChartsCount }),\r\n            react_1.default.createElement(\"div\", { className: \"songRecordsContainer\" },\r\n                react_1.default.createElement(ChartRecordSectionTitle_1.ChartRecordSectionTitle, { title: i18n_1.UIString.newChartsRatingTargets, contentHidden: hideNewTopSongs, onClick: this.toggleNewTopChartsDisplay }),\r\n                react_1.default.createElement(TopChartRecords_1.TopChartRecords, { songPropsByName: songPropsByName, records: newChartRecords, limit: newTopChartsCount, hidden: hideNewTopSongs })),\r\n            react_1.default.createElement(\"div\", { className: \"songRecordsContainer\" },\r\n                react_1.default.createElement(ChartRecordSectionTitle_1.ChartRecordSectionTitle, { title: i18n_1.UIString.oldChartsRatingTargets, contentHidden: hideOldTopSongs, onClick: this.toggleOldTopChartsDisplay }),\r\n                react_1.default.createElement(TopChartRecords_1.TopChartRecords, { songPropsByName: songPropsByName, records: oldChartRecords, limit: oldTopChartsCount, hidden: hideOldTopSongs })),\r\n            react_1.default.createElement(\"div\", { className: \"songRecordsContainer\" },\r\n                react_1.default.createElement(ChartRecordSectionTitle_1.ChartRecordSectionTitle, { title: i18n_1.UIString.newChartsRatingCandidates, contentHidden: hideNewCandidateSongs, onClick: this.toggleNewCandidateChartsDisplay, isCandidateList: true }),\r\n                react_1.default.createElement(CandidatesChartRecords_1.CandidateChartRecords, { name: \"new\", songPropsByName: songPropsByName, records: newChartCandidates, hidden: hideNewCandidateSongs, notPlayed: notPlayedNewCharts })),\r\n            react_1.default.createElement(\"div\", { className: \"songRecordsContainer\" },\r\n                react_1.default.createElement(ChartRecordSectionTitle_1.ChartRecordSectionTitle, { title: i18n_1.UIString.oldChartsRatingCandidates, contentHidden: hideOldCandidateSongs, onClick: this.toggleOldCandidateChartsDisplay, isCandidateList: true }),\r\n                react_1.default.createElement(CandidatesChartRecords_1.CandidateChartRecords, { name: \"old\", songPropsByName: songPropsByName, records: oldChartCandidates, hidden: hideOldCandidateSongs, notPlayed: notPlayedOldCharts })),\r\n            react_1.default.createElement(\"hr\", { className: \"sectionSep\" })));\r\n    }\r\n}\r\nexports.RatingOutput = RatingOutput;\r\n\n\n//# sourceURL=webpack:///./js/rating-calculator/components/RatingOutput.tsx?");

/***/ }),

/***/ "./js/rating-calculator/components/RatingOverview.tsx":
/*!************************************************************!*\
  !*** ./js/rating-calculator/components/RatingOverview.tsx ***!
  \************************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\r\nvar __importDefault = (this && this.__importDefault) || function (mod) {\r\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\r\n};\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.RatingOverview = void 0;\r\nconst react_1 = __importDefault(__webpack_require__(/*! react */ \"react\"));\r\nconst grade_1 = __webpack_require__(/*! ../grade */ \"./js/rating-calculator/grade.ts\");\r\nconst i18n_1 = __webpack_require__(/*! ../i18n */ \"./js/rating-calculator/i18n.ts\");\r\nclass RatingOverview extends react_1.default.PureComponent {\r\n    render() {\r\n        const { oldChartsRating, oldTopChartsCount, newChartsRating, newTopChartsCount, playerGradeIndex, } = this.props;\r\n        let totalRating = newChartsRating + oldChartsRating;\r\n        const playerGrade = playerGradeIndex > 0 ? grade_1.getGradeByIndex(playerGradeIndex) : null;\r\n        if (playerGrade) {\r\n            totalRating += playerGrade.bonus;\r\n        }\r\n        return (react_1.default.createElement(\"div\", { className: \"ratingOverview\" },\r\n            react_1.default.createElement(\"div\", { className: \"totalRatingRow\" },\r\n                \"Rating\\uFF1A \",\r\n                react_1.default.createElement(\"span\", null, totalRating)),\r\n            react_1.default.createElement(\"table\", { className: \"ratingOverviewTable\" },\r\n                react_1.default.createElement(\"tbody\", null,\r\n                    react_1.default.createElement(\"tr\", null,\r\n                        react_1.default.createElement(\"td\", null, i18n_1.UIString.newChartsRating),\r\n                        react_1.default.createElement(\"td\", { className: \"columnColumn\" }, i18n_1.UIString.column),\r\n                        react_1.default.createElement(\"td\", { className: \"subRatingColumn\" }, newChartsRating),\r\n                        react_1.default.createElement(\"td\", { className: \"avgRatingColumn\" },\r\n                            \"(\",\r\n                            i18n_1.UIString.average,\r\n                            i18n_1.UIString.column,\r\n                            \" \",\r\n                            this.getAvg(newChartsRating, newTopChartsCount),\r\n                            \")\")),\r\n                    react_1.default.createElement(\"tr\", null,\r\n                        react_1.default.createElement(\"td\", null, i18n_1.UIString.oldChartsRating),\r\n                        react_1.default.createElement(\"td\", null, i18n_1.UIString.column),\r\n                        react_1.default.createElement(\"td\", { className: \"subRatingColumn\" }, oldChartsRating),\r\n                        react_1.default.createElement(\"td\", { className: \"avgRatingColumn\" },\r\n                            \"(\",\r\n                            i18n_1.UIString.average,\r\n                            i18n_1.UIString.column,\r\n                            \" \",\r\n                            this.getAvg(oldChartsRating, oldTopChartsCount),\r\n                            \")\")),\r\n                    playerGrade && (react_1.default.createElement(\"tr\", null,\r\n                        react_1.default.createElement(\"td\", null,\r\n                            i18n_1.UIString.grade,\r\n                            \" (\",\r\n                            react_1.default.createElement(\"span\", null, playerGrade.title),\r\n                            \")\"),\r\n                        react_1.default.createElement(\"td\", null, i18n_1.UIString.column),\r\n                        react_1.default.createElement(\"td\", { className: \"subRatingColumn\" }, playerGrade.bonus)))))));\r\n    }\r\n    getAvg(sum, count) {\r\n        return count ? (sum / count).toFixed(0) : 0;\r\n    }\r\n}\r\nexports.RatingOverview = RatingOverview;\r\n\n\n//# sourceURL=webpack:///./js/rating-calculator/components/RatingOverview.tsx?");

/***/ }),

/***/ "./js/rating-calculator/components/RecommendedLevelCell.tsx":
/*!******************************************************************!*\
  !*** ./js/rating-calculator/components/RecommendedLevelCell.tsx ***!
  \******************************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\r\nvar __importDefault = (this && this.__importDefault) || function (mod) {\r\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\r\n};\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.RecommendedLevelCell = void 0;\r\nconst react_1 = __importDefault(__webpack_require__(/*! react */ \"react\"));\r\nconst level_helper_1 = __webpack_require__(/*! ../../common/level-helper */ \"./js/common/level-helper.ts\");\r\nfunction getMaimaiSongsLink(officialLv) {\r\n    officialLv = officialLv.replace(\"+\", \".5\");\r\n    return `https://maimai-songs.zetaraku.dev/?maxLevelValue=${officialLv}&minLevelValue=${officialLv}`;\r\n}\r\nclass RecommendedLevelCell extends react_1.default.PureComponent {\r\n    render() {\r\n        const { lv } = this.props;\r\n        if (lv < 0) {\r\n            return react_1.default.createElement(\"td\", null, \"--\");\r\n        }\r\n        const officialLv = level_helper_1.getOfficialLevel(lv);\r\n        return (react_1.default.createElement(\"td\", null,\r\n            react_1.default.createElement(\"a\", { href: getMaimaiSongsLink(officialLv), target: \"_blank\" }, officialLv),\r\n            react_1.default.createElement(\"br\", null),\r\n            \"(\",\r\n            lv.toFixed(1),\r\n            \"~)\"));\r\n    }\r\n}\r\nexports.RecommendedLevelCell = RecommendedLevelCell;\r\n\n\n//# sourceURL=webpack:///./js/rating-calculator/components/RecommendedLevelCell.tsx?");

/***/ }),

/***/ "./js/rating-calculator/components/RecommendedLevels.tsx":
/*!***************************************************************!*\
  !*** ./js/rating-calculator/components/RecommendedLevels.tsx ***!
  \***************************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\r\nvar __importDefault = (this && this.__importDefault) || function (mod) {\r\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\r\n};\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.RecommendedLevels = void 0;\r\nconst react_1 = __importDefault(__webpack_require__(/*! react */ \"react\"));\r\nconst number_helper_1 = __webpack_require__(/*! ../../common/number-helper */ \"./js/common/number-helper.ts\");\r\nconst rank_functions_1 = __webpack_require__(/*! ../../common/rank-functions */ \"./js/common/rank-functions.ts\");\r\nconst i18n_1 = __webpack_require__(/*! ../i18n */ \"./js/rating-calculator/i18n.ts\");\r\nconst RecommendedLevelCell_1 = __webpack_require__(/*! ./RecommendedLevelCell */ \"./js/rating-calculator/components/RecommendedLevelCell.tsx\");\r\nconst MIN_RANK = \"SS\";\r\nconst MAX_LV = 15;\r\nclass RecommendedLevels extends react_1.default.PureComponent {\r\n    render() {\r\n        const { newChartsRating, newTopChartsCount, oldChartsRating, oldTopChartsCount } = this.props;\r\n        let ranks = rank_functions_1.RANK_DEFINITIONS;\r\n        const minRankIdx = ranks.findIndex((r) => r.title === MIN_RANK);\r\n        ranks = ranks\r\n            .slice(0, minRankIdx + 1)\r\n            .filter((r, i, arr) => i === arr.length - 1 || r.title !== arr[i + 1].title);\r\n        const avgNewChartRating = newTopChartsCount > 0 ? Math.floor(newChartsRating / newTopChartsCount) : 0;\r\n        const avgOldChartRating = oldTopChartsCount > 0 ? Math.floor(oldChartsRating / oldTopChartsCount) : 0;\r\n        const newLvs = ranks.map((r) => {\r\n            const lv = this.calcRecommendedLv(avgNewChartRating, r);\r\n            return lv > MAX_LV ? -1 : lv;\r\n        });\r\n        const oldLvs = ranks.map((r) => {\r\n            const lv = this.calcRecommendedLv(avgOldChartRating, r);\r\n            return lv > MAX_LV ? -1 : lv;\r\n        });\r\n        return (react_1.default.createElement(\"div\", { className: \"recLvSection\" },\r\n            react_1.default.createElement(\"h3\", { className: \"recLvTitle\" }, i18n_1.UIString.recommendedLevels),\r\n            react_1.default.createElement(\"p\", { className: \"recLvDesc\" }, i18n_1.UIString.levelComment),\r\n            react_1.default.createElement(\"table\", { className: \"recLvTable\" },\r\n                react_1.default.createElement(\"thead\", null,\r\n                    react_1.default.createElement(\"tr\", null,\r\n                        react_1.default.createElement(\"th\", { className: \"recLvFirstCol\" }),\r\n                        ranks.map((r) => (react_1.default.createElement(\"th\", null,\r\n                            react_1.default.createElement(\"span\", { className: \"recLvRankTitle\" }, r.title),\r\n                            react_1.default.createElement(\"span\", { className: \"recLvRankAchv\" },\r\n                                r.th,\r\n                                \"%\")))),\r\n                        react_1.default.createElement(\"th\", null, i18n_1.UIString.projectedRating))),\r\n                react_1.default.createElement(\"tbody\", null,\r\n                    avgNewChartRating > 0 && (react_1.default.createElement(\"tr\", null,\r\n                        react_1.default.createElement(\"th\", { className: \"recLvFirstCol\" }, i18n_1.UIString.newChartsRecLv),\r\n                        newLvs.map((lv) => (react_1.default.createElement(RecommendedLevelCell_1.RecommendedLevelCell, { lv: lv }))),\r\n                        react_1.default.createElement(\"td\", null,\r\n                            Math.floor(avgNewChartRating),\r\n                            \"\\u2191\"))),\r\n                    avgOldChartRating > 0 && (react_1.default.createElement(\"tr\", null,\r\n                        react_1.default.createElement(\"th\", { className: \"recLvFirstCol\" }, i18n_1.UIString.oldChartsRecLv),\r\n                        oldLvs.map((lv) => (react_1.default.createElement(RecommendedLevelCell_1.RecommendedLevelCell, { lv: lv }))),\r\n                        react_1.default.createElement(\"td\", null,\r\n                            Math.floor(avgOldChartRating),\r\n                            \"\\u2191\")))))));\r\n    }\r\n    calcRecommendedLv(rating, r) {\r\n        return number_helper_1.roundFloat((rating / r.factor / r.th) * 100, \"ceil\", 0.1);\r\n    }\r\n}\r\nexports.RecommendedLevels = RecommendedLevels;\r\n\n\n//# sourceURL=webpack:///./js/rating-calculator/components/RecommendedLevels.tsx?");

/***/ }),

/***/ "./js/rating-calculator/components/RootComponent.tsx":
/*!***********************************************************!*\
  !*** ./js/rating-calculator/components/RootComponent.tsx ***!
  \***********************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\r\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n};\r\nvar __importDefault = (this && this.__importDefault) || function (mod) {\r\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\r\n};\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.RootComponent = void 0;\r\nconst react_1 = __importDefault(__webpack_require__(/*! react */ \"react\"));\r\nconst constants_1 = __webpack_require__(/*! ../../common/constants */ \"./js/common/constants.ts\");\r\nconst magic_1 = __webpack_require__(/*! ../../common/magic */ \"./js/common/magic.ts\");\r\nconst song_props_1 = __webpack_require__(/*! ../../common/song-props */ \"./js/common/song-props.ts\");\r\nconst cache_1 = __webpack_require__(/*! ../cache */ \"./js/rating-calculator/cache.ts\");\r\nconst i18n_1 = __webpack_require__(/*! ../i18n */ \"./js/rating-calculator/i18n.ts\");\r\nconst player_score_parser_1 = __webpack_require__(/*! ../player-score-parser */ \"./js/rating-calculator/player-score-parser.ts\");\r\nconst rating_analyzer_1 = __webpack_require__(/*! ../rating-analyzer */ \"./js/rating-calculator/rating-analyzer.ts\");\r\nconst InternalLvInput_1 = __webpack_require__(/*! ./InternalLvInput */ \"./js/rating-calculator/components/InternalLvInput.tsx\");\r\nconst MultiplierTable_1 = __webpack_require__(/*! ./MultiplierTable */ \"./js/rating-calculator/components/MultiplierTable.tsx\");\r\nconst OtherTools_1 = __webpack_require__(/*! ./OtherTools */ \"./js/rating-calculator/components/OtherTools.tsx\");\r\nconst PageFooter_1 = __webpack_require__(/*! ./PageFooter */ \"./js/rating-calculator/components/PageFooter.tsx\");\r\nconst RatingOutput_1 = __webpack_require__(/*! ./RatingOutput */ \"./js/rating-calculator/components/RatingOutput.tsx\");\r\nconst ScoreInput_1 = __webpack_require__(/*! ./ScoreInput */ \"./js/rating-calculator/components/ScoreInput.tsx\");\r\nconst VersionSelect_1 = __webpack_require__(/*! ./VersionSelect */ \"./js/rating-calculator/components/VersionSelect.tsx\");\r\nconst CACHE_KEY_DX_INNER_LEVEL = \"dxInnerLv\";\r\nconst CACHE_KEY_DX_PLUS_INNER_LEVEL = \"dxPlusInnerLv\";\r\nconst CACHE_KEY_DX_SPLASH_INNER_LEVEL = \"dxSplashInnerLv\";\r\nfunction getInternalLvCacheKey(gameVer) {\r\n    switch (gameVer) {\r\n        case constants_1.DX_PLUS_GAME_VERSION:\r\n            return CACHE_KEY_DX_PLUS_INNER_LEVEL;\r\n        case constants_1.DX_SPLASH_GAME_VERSION:\r\n            return CACHE_KEY_DX_SPLASH_INNER_LEVEL;\r\n        default:\r\n            return CACHE_KEY_DX_INNER_LEVEL;\r\n    }\r\n}\r\nfunction getDebugText(data) {\r\n    if (typeof data === \"string\") {\r\n        return \"string of length \" + data.length;\r\n    }\r\n    return data;\r\n}\r\nfunction readSongProperties(gameVer, inputText) {\r\n    return new Promise((resolve) => {\r\n        // Read from user input\r\n        if (inputText.length > 0) {\r\n            resolve(song_props_1.buildSongPropsMap(inputText));\r\n            return;\r\n        }\r\n        // Read from cache\r\n        const cacheKey = getInternalLvCacheKey(gameVer);\r\n        const cachedInternalLv = cache_1.readFromCache(cacheKey);\r\n        if (cachedInternalLv) {\r\n            resolve(song_props_1.buildSongPropsMap(cachedInternalLv));\r\n            return;\r\n        }\r\n        // Read from Internet\r\n        console.log(\"Magic happening...\");\r\n        magic_1.iWantSomeMagic(gameVer).then((responseText) => {\r\n            cache_1.writeToCache(cacheKey, responseText);\r\n            resolve(song_props_1.buildSongPropsMap(responseText));\r\n        });\r\n    });\r\n}\r\nfunction readPlayerScoreFromText(text) {\r\n    return __awaiter(this, void 0, void 0, function* () {\r\n        const lines = text.split(\"\\n\");\r\n        const playerScores = [];\r\n        for (const line of lines) {\r\n            const scoreRecord = player_score_parser_1.parseScoreLine(line);\r\n            if (scoreRecord) {\r\n                playerScores.push(scoreRecord);\r\n            }\r\n        }\r\n        return playerScores;\r\n    });\r\n}\r\nclass RootComponent extends react_1.default.PureComponent {\r\n    constructor(props) {\r\n        super(props);\r\n        this.playerGradeIndex = 0;\r\n        this.lvInput = react_1.default.createRef();\r\n        this.scoreInput = react_1.default.createRef();\r\n        this.referrer = document.referrer && new URL(document.referrer).origin;\r\n        this.selectVersion = (gameVer) => {\r\n            this.setState({ gameVer }, this.analyzeRating);\r\n        };\r\n        this.analyzeRating = (evt) => __awaiter(this, void 0, void 0, function* () {\r\n            if (evt) {\r\n                evt.preventDefault();\r\n            }\r\n            const songPropsText = this.lvInput.current ? this.lvInput.current.getInput() : \"\";\r\n            const scoreText = this.scoreInput.current ? this.scoreInput.current.getInput() : \"\";\r\n            const { gameVer } = this.state;\r\n            console.log(\"gameVer\", gameVer);\r\n            const songPropsByName = yield readSongProperties(gameVer, songPropsText);\r\n            console.log(\"Song properties:\", songPropsByName);\r\n            const playerScores = yield readPlayerScoreFromText(scoreText);\r\n            console.log(\"Player scores:\", playerScores);\r\n            if (!playerScores.length) {\r\n                this.setState({ ratingData: undefined, showMultiplierTable: true });\r\n                return;\r\n            }\r\n            const ratingData = yield rating_analyzer_1.analyzePlayerRating(songPropsByName, playerScores, gameVer);\r\n            console.log(\"Rating Data:\", ratingData);\r\n            this.setState({ ratingData, showMultiplierTable: true, songPropsByName });\r\n        });\r\n        const queryParams = new URLSearchParams(document.location.search);\r\n        const dxVersionQueryParam = queryParams.get(\"gameVersion\");\r\n        const gameVer = dxVersionQueryParam ? parseInt(dxVersionQueryParam) : constants_1.DX_PLUS_GAME_VERSION;\r\n        let showMultiplierTable = queryParams.get(\"quickLookup\") !== \"hide\";\r\n        const friendIdx = queryParams.get(\"friendIdx\");\r\n        const playerName = queryParams.get(\"playerName\");\r\n        this.state = {\r\n            gameVer,\r\n            showMultiplierTable,\r\n            friendIdx,\r\n            playerName,\r\n        };\r\n        if (window.opener) {\r\n            this.initWindowCommunication();\r\n        }\r\n    }\r\n    componentDidUpdate(_prevProps, prevState) {\r\n        if (this.state.songPropsByName &&\r\n            ((!this.state.oldSongs && !this.state.newSongs) || prevState.gameVer !== this.state.gameVer)) {\r\n            this.loadSongLists(this.state.gameVer);\r\n        }\r\n    }\r\n    render() {\r\n        const { gameVer, showMultiplierTable, playerName, ratingData, songPropsByName, oldSongs, newSongs, } = this.state;\r\n        return (react_1.default.createElement(react_1.default.Fragment, null,\r\n            react_1.default.createElement(VersionSelect_1.VersionSelect, { gameVer: gameVer, handleVersionSelect: this.selectVersion }),\r\n            react_1.default.createElement(InternalLvInput_1.InternalLvInput, { ref: this.lvInput }),\r\n            react_1.default.createElement(ScoreInput_1.ScoreInput, { ref: this.scoreInput }),\r\n            react_1.default.createElement(\"div\", { className: \"actionArea\" },\r\n                react_1.default.createElement(\"button\", { className: \"analyzeRatingBtn\", onClick: this.analyzeRating }, i18n_1.UIString.computeRating)),\r\n            react_1.default.createElement(\"hr\", { className: \"sectionSep\" }),\r\n            ratingData && (react_1.default.createElement(RatingOutput_1.RatingOutput, { songPropsByName: songPropsByName, ratingData: ratingData, playerGradeIndex: this.playerGradeIndex, playerName: playerName, oldSongs: oldSongs, newSongs: newSongs })),\r\n            showMultiplierTable && react_1.default.createElement(MultiplierTable_1.MultiplierTable, null),\r\n            react_1.default.createElement(OtherTools_1.OtherTools, null),\r\n            react_1.default.createElement(PageFooter_1.PageFooter, null)));\r\n    }\r\n    postMessageToOpener(data) {\r\n        if (window.opener) {\r\n            if (this.referrer) {\r\n                window.opener.postMessage(data, this.referrer);\r\n            }\r\n            else {\r\n                window.opener.postMessage(data, \"https://maimaidx-eng.com\");\r\n                window.opener.postMessage(data, \"https://maimaidx.jp\");\r\n            }\r\n        }\r\n    }\r\n    initWindowCommunication() {\r\n        window.addEventListener(\"message\", (evt) => {\r\n            console.log(evt.origin, evt.data.action, getDebugText(evt.data.payload));\r\n            if (evt.origin === \"https://maimaidx-eng.com\" || evt.origin === \"https://maimaidx.jp\") {\r\n                let payloadAsInt;\r\n                switch (evt.data.action) {\r\n                    case \"gameVersion\":\r\n                        payloadAsInt = parseInt(evt.data.payload);\r\n                        if (payloadAsInt >= constants_1.DX_PLUS_GAME_VERSION && payloadAsInt <= constants_1.DX_SPLASH_GAME_VERSION) {\r\n                            this.setState({ gameVer: payloadAsInt });\r\n                        }\r\n                        break;\r\n                    case \"playerGrade\":\r\n                        payloadAsInt = parseInt(evt.data.payload);\r\n                        if (payloadAsInt) {\r\n                            this.playerGradeIndex = payloadAsInt;\r\n                        }\r\n                        break;\r\n                    case \"replacePlayerScore\":\r\n                        this.scoreInput.current.setText(evt.data.payload);\r\n                        break;\r\n                    case \"appendPlayerScore\":\r\n                        this.scoreInput.current.appendText(evt.data.payload);\r\n                        break;\r\n                    case \"calculateRating\":\r\n                        this.analyzeRating();\r\n                        break;\r\n                    case \"allSongs\":\r\n                        this.setState({\r\n                            oldSongs: song_props_1.filterSongsByVersion(evt.data.payload, this.state.songPropsByName, this.state.gameVer, 1 /* OLDER */),\r\n                        });\r\n                        break;\r\n                    case \"newSongs\":\r\n                        this.setState({\r\n                            newSongs: song_props_1.filterSongsByVersion(evt.data.payload, this.state.songPropsByName, this.state.gameVer, 0 /* EQUAL */),\r\n                        });\r\n                        break;\r\n                }\r\n            }\r\n        });\r\n        const { friendIdx } = this.state;\r\n        if (friendIdx) {\r\n            // Analyze friend rating\r\n            this.postMessageToOpener({ action: \"getFriendRecords\", payload: friendIdx });\r\n        }\r\n        else {\r\n            // Analyze self rating\r\n            this.postMessageToOpener(\"ready\");\r\n        }\r\n    }\r\n    loadSongLists(gameVer) {\r\n        this.postMessageToOpener({ action: \"fetchAllSongs\" });\r\n        this.postMessageToOpener({ action: \"fetchNewSongs\", payload: gameVer });\r\n    }\r\n}\r\nexports.RootComponent = RootComponent;\r\n\n\n//# sourceURL=webpack:///./js/rating-calculator/components/RootComponent.tsx?");

/***/ }),

/***/ "./js/rating-calculator/components/ScoreInput.tsx":
/*!********************************************************!*\
  !*** ./js/rating-calculator/components/ScoreInput.tsx ***!
  \********************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\r\nvar __importDefault = (this && this.__importDefault) || function (mod) {\r\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\r\n};\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.ScoreInput = void 0;\r\nconst react_1 = __importDefault(__webpack_require__(/*! react */ \"react\"));\r\nconst i18n_1 = __webpack_require__(/*! ../i18n */ \"./js/rating-calculator/i18n.ts\");\r\nclass ScoreInput extends react_1.default.PureComponent {\r\n    constructor() {\r\n        super(...arguments);\r\n        this.textareaRef = react_1.default.createRef();\r\n    }\r\n    render() {\r\n        return (react_1.default.createElement(\"div\", { className: \"w90\" },\r\n            react_1.default.createElement(\"h2\", { className: \"scoreInputHeading\" }, i18n_1.UIString.scoreInputHeading),\r\n            react_1.default.createElement(\"div\", null,\r\n                i18n_1.UIString.scoreInputDescPrefix,\r\n                react_1.default.createElement(\"a\", { href: \"/mai-tools/bookmarklets/\", target: \"_blank\" }, i18n_1.UIString.bookmarketLinkLabel),\r\n                i18n_1.UIString.scoreInputDescSuffix),\r\n            react_1.default.createElement(\"textarea\", { className: \"scoreInputArea\", ref: this.textareaRef })));\r\n    }\r\n    getInput() {\r\n        if (this.textareaRef.current) {\r\n            return this.textareaRef.current.value;\r\n        }\r\n        return \"\";\r\n    }\r\n    setText(text) {\r\n        if (this.textareaRef.current) {\r\n            this.textareaRef.current.value = text;\r\n        }\r\n    }\r\n    appendText(text) {\r\n        if (this.textareaRef.current) {\r\n            this.textareaRef.current.value += text + \"\\n\";\r\n        }\r\n    }\r\n}\r\nexports.ScoreInput = ScoreInput;\r\n\n\n//# sourceURL=webpack:///./js/rating-calculator/components/ScoreInput.tsx?");

/***/ }),

/***/ "./js/rating-calculator/components/TopChartRecords.tsx":
/*!*************************************************************!*\
  !*** ./js/rating-calculator/components/TopChartRecords.tsx ***!
  \*************************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\r\nvar __importDefault = (this && this.__importDefault) || function (mod) {\r\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\r\n};\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.TopChartRecords = void 0;\r\nconst react_1 = __importDefault(__webpack_require__(/*! react */ \"react\"));\r\nconst i18n_1 = __webpack_require__(/*! ../i18n */ \"./js/rating-calculator/i18n.ts\");\r\nconst record_comparator_1 = __webpack_require__(/*! ../record-comparator */ \"./js/rating-calculator/record-comparator.ts\");\r\nconst ChartRecordsTable_1 = __webpack_require__(/*! ./ChartRecordsTable */ \"./js/rating-calculator/components/ChartRecordsTable.tsx\");\r\nconst CollapsibleContainer_1 = __webpack_require__(/*! ./CollapsibleContainer */ \"./js/rating-calculator/components/CollapsibleContainer.tsx\");\r\nconst DifficultyDistribution_1 = __webpack_require__(/*! ./DifficultyDistribution */ \"./js/rating-calculator/components/DifficultyDistribution.tsx\");\r\nconst LevelRankDistribution_1 = __webpack_require__(/*! ./LevelRankDistribution */ \"./js/rating-calculator/components/LevelRankDistribution.tsx\");\r\nconst COLUMNS = [\r\n    0 /* NO */,\r\n    1 /* SONG_TITLE */,\r\n    2 /* DIFFICULTY */,\r\n    3 /* LEVEL */,\r\n    4 /* ACHIEVEMENT */,\r\n    5 /* RANK */,\r\n    7 /* RATING */,\r\n];\r\nconst COMPARATOR = new Map([\r\n    [1 /* SONG_TITLE */, record_comparator_1.compareSongsByName],\r\n    [2 /* DIFFICULTY */, record_comparator_1.compareSongsByDifficulty],\r\n    [3 /* LEVEL */, record_comparator_1.compareSongsByLevel],\r\n    [4 /* ACHIEVEMENT */, record_comparator_1.compareSongsByAchv],\r\n    [5 /* RANK */, record_comparator_1.compareSongsByAchv],\r\n    [7 /* RATING */, record_comparator_1.compareSongsByRating],\r\n]);\r\nclass TopChartRecords extends react_1.default.PureComponent {\r\n    constructor() {\r\n        super(...arguments);\r\n        this.state = { sortBy: 7 /* RATING */ };\r\n        this.handleSortBy = (col) => {\r\n            this.setState((state) => {\r\n                if (!COMPARATOR.has(col)) {\r\n                    this.setState({ sortBy: undefined });\r\n                }\r\n                else if (col === state.sortBy) {\r\n                    this.setState({ reverse: !state.reverse });\r\n                }\r\n                else {\r\n                    this.setState({ sortBy: col, reverse: false });\r\n                }\r\n            });\r\n        };\r\n    }\r\n    render() {\r\n        const { hidden, records: allRecords, limit, songPropsByName } = this.props;\r\n        const { sortBy, reverse } = this.state;\r\n        let records = allRecords.slice(0, limit);\r\n        records.forEach((r, i) => (r.order = i + 1));\r\n        if (sortBy) {\r\n            records.sort(COMPARATOR.get(sortBy));\r\n            if (reverse) {\r\n                records.reverse();\r\n            }\r\n        }\r\n        return (react_1.default.createElement(CollapsibleContainer_1.CollapsibleContainer, { className: \"songRecordTableContainer\", hidden: hidden },\r\n            react_1.default.createElement(\"div\", { className: \"responsiveFlexBox\" },\r\n                react_1.default.createElement(LevelRankDistribution_1.LevelRankDistribution, { topLeftCell: i18n_1.UIString.level, chartRecords: records, topChartsCount: limit }),\r\n                react_1.default.createElement(DifficultyDistribution_1.DifficultyDistribution, { chartRecords: records, topChartsCount: limit })),\r\n            react_1.default.createElement(ChartRecordsTable_1.ChartRecordsTable, { songPropsByName: songPropsByName, columns: COLUMNS, tableClassname: \"topRecordTable\", records: records, sortBy: this.handleSortBy })));\r\n    }\r\n}\r\nexports.TopChartRecords = TopChartRecords;\r\n\n\n//# sourceURL=webpack:///./js/rating-calculator/components/TopChartRecords.tsx?");

/***/ }),

/***/ "./js/rating-calculator/components/VersionSelect.tsx":
/*!***********************************************************!*\
  !*** ./js/rating-calculator/components/VersionSelect.tsx ***!
  \***********************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\r\nvar __importDefault = (this && this.__importDefault) || function (mod) {\r\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\r\n};\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.VersionSelect = void 0;\r\nconst react_1 = __importDefault(__webpack_require__(/*! react */ \"react\"));\r\nconst i18n_1 = __webpack_require__(/*! ../i18n */ \"./js/rating-calculator/i18n.ts\");\r\nclass VersionSelect extends react_1.default.PureComponent {\r\n    constructor() {\r\n        super(...arguments);\r\n        this.handleChange = (evt) => {\r\n            this.props.handleVersionSelect(parseInt(evt.currentTarget.value));\r\n        };\r\n    }\r\n    render() {\r\n        const { gameVer } = this.props;\r\n        const ver = gameVer.toFixed(0);\r\n        return (react_1.default.createElement(\"label\", null,\r\n            i18n_1.UIString.gameVer,\r\n            react_1.default.createElement(\"select\", { className: \"gameVersion\", onChange: this.handleChange },\r\n                react_1.default.createElement(\"option\", { value: \"14\", selected: ver === \"14\" }, \"DX Plus\"),\r\n                react_1.default.createElement(\"option\", { value: \"15\", selected: ver === \"15\" }, \"DX Splash\"))));\r\n    }\r\n}\r\nexports.VersionSelect = VersionSelect;\r\n\n\n//# sourceURL=webpack:///./js/rating-calculator/components/VersionSelect.tsx?");

/***/ }),

/***/ "./js/rating-calculator/grade.ts":
/*!***************************************!*\
  !*** ./js/rating-calculator/grade.ts ***!
  \***************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.getGradeByIndex = void 0;\r\nconst GRADES_DX = [\r\n    { title: \"\", bonus: 0 },\r\n    { title: \"初心者\", bonus: 0 },\r\n    { title: \"見習い\", bonus: 250 },\r\n    { title: \"駆け出し\", bonus: 500 },\r\n    { title: \"修行中\", bonus: 750 },\r\n    { title: \"初段\", bonus: 1000 },\r\n    { title: \"二段\", bonus: 1200 },\r\n    { title: \"三段\", bonus: 1400 },\r\n    { title: \"四段\", bonus: 1500 },\r\n    { title: \"五段\", bonus: 1600 },\r\n    { title: \"六段\", bonus: 1700 },\r\n    { title: \"七段\", bonus: 1800 },\r\n    { title: \"八段\", bonus: 1850 },\r\n    { title: \"九段\", bonus: 1900 },\r\n    { title: \"十段\", bonus: 1950 },\r\n    { title: \"皆伝\", bonus: 2000 },\r\n    { title: \"壱皆伝\", bonus: 2010 },\r\n    { title: \"弐皆伝\", bonus: 2020 },\r\n    { title: \"参皆伝\", bonus: 2030 },\r\n    { title: \"肆皆伝\", bonus: 2040 },\r\n    { title: \"伍皆伝\", bonus: 2050 },\r\n    { title: \"陸皆伝\", bonus: 2060 },\r\n    { title: \"漆皆伝\", bonus: 2070 },\r\n    { title: \"捌皆伝\", bonus: 2080 },\r\n    { title: \"玖皆伝\", bonus: 2090 },\r\n    { title: \"拾皆伝\", bonus: 2100 },\r\n];\r\nfunction getGradeByIndex(index) {\r\n    return GRADES_DX[index];\r\n}\r\nexports.getGradeByIndex = getGradeByIndex;\r\n\n\n//# sourceURL=webpack:///./js/rating-calculator/grade.ts?");

/***/ }),

/***/ "./js/rating-calculator/i18n.ts":
/*!**************************************!*\
  !*** ./js/rating-calculator/i18n.ts ***!
  \**************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.UIString = void 0;\r\nconst lang_1 = __webpack_require__(/*! ../common/lang */ \"./js/common/lang.ts\");\r\nconst UIStringByLang = {\r\n    en: {\r\n        gameVer: \"Game version:\",\r\n        internalLvHeading: \"Chart Internal Level Data\",\r\n        manualLv: \"Manual input\",\r\n        autoLv: \"Automatic\",\r\n        scoreInputHeading: \"Player Scores\",\r\n        scoreInputDescPrefix: 'Please use \"Analyze DX Rating\" or \"Download all scores\" from ',\r\n        bookmarketLinkLabel: \"maimai bookmarklets\",\r\n        scoreInputDescSuffix: \" to fill in this field.\",\r\n        computeRating: \"Calculate Rating\",\r\n        analysisResult: \"Analysis Result\",\r\n        newChartsRecLv: \"New Charts\",\r\n        oldChartsRecLv: \"Old Charts\",\r\n        newChartsRating: \"New Charts Rating\",\r\n        oldChartsRating: \"Old Charts Rating\",\r\n        grade: \"Grade\",\r\n        ratingTargetLvDistribution: \"Levels of Rating Subjects\",\r\n        ratingTargetDiffDistribution: \"Difficulties of Rating Subjects\",\r\n        column: \":\",\r\n        subtotal: \"Subtotal\",\r\n        newChartsRatingTargets: \"New Charts Rating Subjects (best 15):\",\r\n        oldChartsRatingTargets: \"Old Charts Rating Subjects (best 25):\",\r\n        newChartsRatingCandidates: \"New Charts Rating Candidates:\",\r\n        oldChartsRatingCandidates: \"Old Charts Rating Candidates:\",\r\n        num: \"#\",\r\n        song: \"Song\",\r\n        difficulty: \"Difficulty\",\r\n        level: \"Level\",\r\n        rating: \"Rating\",\r\n        nextGoal: \"Next Goal\",\r\n        nextRating: \"+Rating\",\r\n        rankFactorTable: \"Rank Factor Table\",\r\n        rank: \"Rank\",\r\n        achievement: \"Achievement\",\r\n        achievementAbbr: \"Achv\",\r\n        factor: \"Factor\",\r\n        multiplier: \"Multiplier (Factor × Achievement)\",\r\n        otherToolsHeading: \"Other Tools\",\r\n        ratingVisualizer: \"Rating Visualizer (Interactive Page)\",\r\n        bookmarketList: \"Bookmarklets list\",\r\n        showMore: \"Show more\",\r\n        showLess: \"Show less\",\r\n        recommendedLevels: \"Recommended levels\",\r\n        tilde: \"~\",\r\n        projectedRating: \"Potential Rating\",\r\n        levelComment: \"Note: X.7 and above is classified under X+. For example, 10.7, 10.8, and 10.9 are 10+.\",\r\n        average: \"Average\",\r\n        showPlayed: \"Show played charts\",\r\n        showNotPlayed: \"Show not yet played charts\",\r\n    },\r\n    zh: {\r\n        gameVer: \"遊戲版本：\",\r\n        internalLvHeading: \"譜面定數\",\r\n        manualLv: \"手動輸入\",\r\n        autoLv: \"自動代入\",\r\n        scoreInputHeading: \"玩家成績輸入\",\r\n        scoreInputDescPrefix: \"請用 \",\r\n        bookmarketLinkLabel: \"maimai 書籤小工具\",\r\n        scoreInputDescSuffix: \" 中的「分析 DX Rating」或「下載所有歌曲成績」填入此欄。\",\r\n        computeRating: \"計算 Rating 值\",\r\n        analysisResult: \"分析結果\",\r\n        newChartsRecLv: \"新譜面\",\r\n        oldChartsRecLv: \"舊譜面\",\r\n        newChartsRating: \"新譜面 Rating\",\r\n        oldChartsRating: \"舊譜面 Rating\",\r\n        grade: \"段位\",\r\n        ratingTargetLvDistribution: \"Rating 對象曲 等級分布\",\r\n        ratingTargetDiffDistribution: \"Rating 對象曲 難度分布\",\r\n        column: \"：\",\r\n        subtotal: \"小計\",\r\n        newChartsRatingTargets: \"新譜面 Rating 對象曲 (取最佳 15 首)：\",\r\n        oldChartsRatingTargets: \"舊譜面 Rating 對象曲 (取最佳 25 首)：\",\r\n        newChartsRatingCandidates: \"新譜面 Rating 候選曲：\",\r\n        oldChartsRatingCandidates: \"舊譜面 Rating 候選曲：\",\r\n        num: \"#\",\r\n        song: \"歌曲\",\r\n        difficulty: \"難度\",\r\n        level: \"等級\",\r\n        rating: \"R 值\",\r\n        nextGoal: \"下個\\n目標\",\r\n        nextRating: \"R 值\\n加分\",\r\n        rankFactorTable: \"Rank 係數表\",\r\n        rank: \"Rank\",\r\n        achievement: \"達成率\",\r\n        achievementAbbr: \"達成率\",\r\n        factor: \"係數\",\r\n        multiplier: \"倍率 (係數 × 達成率)\",\r\n        otherToolsHeading: \"其他工具\",\r\n        ratingVisualizer: \"R 值視覺化互動式網頁\",\r\n        bookmarketList: \"書籤小工具列表\",\r\n        showMore: \"顯示更多\",\r\n        showLess: \"顯示較少\",\r\n        recommendedLevels: \"刷分目標 (推薦等級)\",\r\n        tilde: \"～\",\r\n        projectedRating: \"可獲得 R 值\",\r\n        levelComment: \"註：X.7 以上是歸類在官方的 X+。舉例來說：10.7, 10.8, 10.9 都算是 10+。\",\r\n        average: \"平均\",\r\n        showPlayed: \"顯示已玩過的譜面\",\r\n        showNotPlayed: \"顯示未玩過的譜面\",\r\n    },\r\n};\r\nexports.UIString = UIStringByLang[lang_1.LANG];\r\n\n\n//# sourceURL=webpack:///./js/rating-calculator/i18n.ts?");

/***/ }),

/***/ "./js/rating-calculator/main.ts":
/*!**************************************!*\
  !*** ./js/rating-calculator/main.ts ***!
  \**************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\r\nvar __importDefault = (this && this.__importDefault) || function (mod) {\r\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\r\n};\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nconst react_1 = __importDefault(__webpack_require__(/*! react */ \"react\"));\r\nconst react_dom_1 = __importDefault(__webpack_require__(/*! react-dom */ \"react-dom\"));\r\nconst lang_1 = __webpack_require__(/*! ../common/lang */ \"./js/common/lang.ts\");\r\nconst RootComponent_1 = __webpack_require__(/*! ./components/RootComponent */ \"./js/rating-calculator/components/RootComponent.tsx\");\r\ndocument.title = {\r\n    zh: \"maimai DX R 值分析工具\",\r\n    en: \"maimai DX Rating Analyzer\",\r\n}[lang_1.LANG];\r\nreact_dom_1.default.render(react_1.default.createElement(RootComponent_1.RootComponent), document.getElementById(\"root\"));\r\n\n\n//# sourceURL=webpack:///./js/rating-calculator/main.ts?");

/***/ }),

/***/ "./js/rating-calculator/player-score-parser.ts":
/*!*****************************************************!*\
  !*** ./js/rating-calculator/player-score-parser.ts ***!
  \*****************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.parseScoreLine = void 0;\r\nconst constants_1 = __webpack_require__(/*! ../common/constants */ \"./js/common/constants.ts\");\r\nconst level_helper_1 = __webpack_require__(/*! ../common/level-helper */ \"./js/common/level-helper.ts\");\r\nconst rank_functions_1 = __webpack_require__(/*! ../common/rank-functions */ \"./js/common/rank-functions.ts\");\r\nfunction getScoreMultiplier(achievement) {\r\n    achievement = Math.min(achievement, constants_1.SSSPLUS_MIN_ACHIEVEMENT);\r\n    const rank = rank_functions_1.getRankByAchievement(achievement);\r\n    if (!rank) {\r\n        console.warn(`Could not find rank for achievement ${achievement.toFixed(4)}%`);\r\n    }\r\n    const factor = rank ? rank.factor : 5;\r\n    const multiplier = (factor * achievement) / 100;\r\n    return { factor, multiplier };\r\n}\r\nfunction parseScoreLine(line) {\r\n    const [songName, genre, difficulty, level, chartType, achievementText] = line.split(\"\\t\");\r\n    if (songName && genre && difficulty && level && chartType && achievementText) {\r\n        const achievement = parseFloat(achievementText);\r\n        const scoreMultiplier = getScoreMultiplier(achievement);\r\n        return {\r\n            songName,\r\n            genre,\r\n            difficulty,\r\n            level: level_helper_1.getDefaultLevel(level),\r\n            levelIsEstimate: true,\r\n            chartType: chartType === \"DX\" ? 1 /* DX */ : 0 /* STANDARD */,\r\n            achievement,\r\n            multiplier: scoreMultiplier.multiplier,\r\n            rankFactor: scoreMultiplier.factor,\r\n        };\r\n    }\r\n}\r\nexports.parseScoreLine = parseScoreLine;\r\n\n\n//# sourceURL=webpack:///./js/rating-calculator/player-score-parser.ts?");

/***/ }),

/***/ "./js/rating-calculator/rank-distribution.tsx":
/*!****************************************************!*\
  !*** ./js/rating-calculator/rank-distribution.tsx ***!
  \****************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.getRankMap = exports.getRankDistribution = void 0;\r\nconst rank_functions_1 = __webpack_require__(/*! ../common/rank-functions */ \"./js/common/rank-functions.ts\");\r\nfunction getRankDistribution(scoreList) {\r\n    const countPerRank = new Map();\r\n    for (const rankDef of rank_functions_1.RANK_DEFINITIONS) {\r\n        countPerRank.set(rankDef.title, 0);\r\n    }\r\n    scoreList.forEach((record) => {\r\n        const rankTitle = rank_functions_1.getRankTitle(record.achievement);\r\n        const rankCount = countPerRank.get(rankTitle);\r\n        countPerRank.set(rankTitle, rankCount + 1);\r\n    });\r\n    return countPerRank;\r\n}\r\nexports.getRankDistribution = getRankDistribution;\r\nfunction getRankMap(records) {\r\n    const overallRankDistribution = getRankDistribution(records);\r\n    const rankMap = new Map();\r\n    let remaining = records.length;\r\n    for (const [rank, count] of overallRankDistribution) {\r\n        if (remaining > 0) {\r\n            rankMap.set(rank, true);\r\n        }\r\n        remaining -= count;\r\n    }\r\n    return rankMap;\r\n}\r\nexports.getRankMap = getRankMap;\r\n\n\n//# sourceURL=webpack:///./js/rating-calculator/rank-distribution.tsx?");

/***/ }),

/***/ "./js/rating-calculator/rating-analyzer.ts":
/*!*************************************************!*\
  !*** ./js/rating-calculator/rating-analyzer.ts ***!
  \*************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\r\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n};\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.analyzePlayerRating = exports.analyzeSongRating = void 0;\r\nconst constants_1 = __webpack_require__(/*! ../common/constants */ \"./js/common/constants.ts\");\r\nconst song_props_1 = __webpack_require__(/*! ../common/song-props */ \"./js/common/song-props.ts\");\r\nconst record_comparator_1 = __webpack_require__(/*! ./record-comparator */ \"./js/rating-calculator/record-comparator.ts\");\r\nconst NUM_TOP_NEW_SONGS = 15;\r\nconst NUM_TOP_OLD_SONGS = 25;\r\n/**\r\n * Compute rating value based on the chart level and player achievement.\r\n * If we don't find the inner level for the chart, use its estimated level and move on.\r\n */\r\nfunction analyzeSongRating(record, songProps) {\r\n    if (songProps) {\r\n        const lvIndex = constants_1.DIFFICULTIES.indexOf(record.difficulty);\r\n        const lv = songProps.lv[lvIndex];\r\n        if (typeof lv === \"number\") {\r\n            record.levelIsEstimate = lv < 0;\r\n            record.level = Math.abs(lv);\r\n        }\r\n    }\r\n    return Object.assign(Object.assign({}, record), { rating: record.level * record.multiplier });\r\n}\r\nexports.analyzeSongRating = analyzeSongRating;\r\nfunction analyzePlayerRating(songPropsByName, playerScores, gameVersion) {\r\n    return __awaiter(this, void 0, void 0, function* () {\r\n        const newChartRecords = [];\r\n        const oldChartRecords = [];\r\n        for (const record of playerScores) {\r\n            const songProps = song_props_1.getSongProperties(songPropsByName, record.songName, record.genre, record.chartType);\r\n            const isNewChart = songProps\r\n                ? songProps.debut === gameVersion\r\n                : record.chartType === 1 /* DX */;\r\n            const recordWithRating = analyzeSongRating(record, songProps);\r\n            if (isNewChart) {\r\n                newChartRecords.push(recordWithRating);\r\n            }\r\n            else {\r\n                oldChartRecords.push(recordWithRating);\r\n            }\r\n        }\r\n        newChartRecords.sort(record_comparator_1.compareSongsByRating);\r\n        oldChartRecords.sort(record_comparator_1.compareSongsByRating);\r\n        let newChartsRating = 0;\r\n        const newTopChartsCount = Math.min(NUM_TOP_NEW_SONGS, newChartRecords.length);\r\n        for (let i = 0; i < newTopChartsCount; i++) {\r\n            newChartsRating += Math.floor(newChartRecords[i].rating);\r\n        }\r\n        let oldChartsRating = 0;\r\n        const oldTopChartsCount = Math.min(NUM_TOP_OLD_SONGS, oldChartRecords.length);\r\n        for (let i = 0; i < oldTopChartsCount; i++) {\r\n            oldChartsRating += Math.floor(oldChartRecords[i].rating);\r\n        }\r\n        return {\r\n            newChartRecords,\r\n            newChartsRating,\r\n            newTopChartsCount,\r\n            oldChartRecords,\r\n            oldChartsRating,\r\n            oldTopChartsCount,\r\n        };\r\n    });\r\n}\r\nexports.analyzePlayerRating = analyzePlayerRating;\r\n\n\n//# sourceURL=webpack:///./js/rating-calculator/rating-analyzer.ts?");

/***/ }),

/***/ "./js/rating-calculator/rating-functions.ts":
/*!**************************************************!*\
  !*** ./js/rating-calculator/rating-functions.ts ***!
  \**************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.calculateRatingRange = void 0;\r\nconst rank_functions_1 = __webpack_require__(/*! ../common/rank-functions */ \"./js/common/rank-functions.ts\");\r\nfunction calculateRatingRange(lv, rank) {\r\n    const rankDefs = rank_functions_1.RANK_DEFINITIONS;\r\n    const idx = rankDefs.indexOf(rank);\r\n    const maxAchv = idx >= 1 ? rankDefs[idx - 1].th - 0.0001 : rank.th;\r\n    const minRating = Math.floor((lv * rank.th * rank.factor) / 100);\r\n    const maxRating = Math.floor((lv * maxAchv * rank.factor) / 100);\r\n    return [minRating, maxRating];\r\n}\r\nexports.calculateRatingRange = calculateRatingRange;\r\n\n\n//# sourceURL=webpack:///./js/rating-calculator/rating-functions.ts?");

/***/ }),

/***/ "./js/rating-calculator/record-comparator.ts":
/*!***************************************************!*\
  !*** ./js/rating-calculator/record-comparator.ts ***!
  \***************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.compareSongsByDifficulty = exports.compareSongsByNextRank = exports.compareSongsByName = exports.compareSongsByAchv = exports.compareSongsByLevel = exports.compareSongsByNextRating = exports.compareCandidate = exports.compareSongsByRating = void 0;\r\nconst constants_1 = __webpack_require__(/*! ../common/constants */ \"./js/common/constants.ts\");\r\nfunction compareNumbers(x, y) {\r\n    return x > y ? -1 : Number(x < y);\r\n}\r\nfunction compareSongsByStrAttr(a, b, f) {\r\n    return a[f].localeCompare(b[f]);\r\n}\r\nfunction compareSongsByNumAttr(a, b, f) {\r\n    return compareNumbers(a[f], b[f]);\r\n}\r\nfunction compareSongsByRating(record1, record2) {\r\n    return (compareSongsByNumAttr(record1, record2, \"rating\") ||\r\n        compareSongsByNumAttr(record1, record2, \"level\") ||\r\n        compareSongsByNumAttr(record1, record2, \"achievement\"));\r\n}\r\nexports.compareSongsByRating = compareSongsByRating;\r\nfunction compareCandidate(record1, record2) {\r\n    const nextRating1 = record1.nextRanks.values().next().value;\r\n    const costPerformance1 = nextRating1.minRt / (nextRating1.rank.th - record1.achievement);\r\n    const nextRating2 = record2.nextRanks.values().next().value;\r\n    const costPerformance2 = nextRating2.minRt / (nextRating2.rank.th - record2.achievement);\r\n    return (compareNumbers(costPerformance1, costPerformance2) ||\r\n        compareNumbers(nextRating1.minRt, nextRating2.minRt) ||\r\n        compareSongsByNumAttr(record1, record2, \"level\"));\r\n}\r\nexports.compareCandidate = compareCandidate;\r\nfunction compareSongsByNextRating(record1, record2) {\r\n    const nextRating1 = record1.nextRanks.values().next().value;\r\n    const nextRating2 = record2.nextRanks.values().next().value;\r\n    return (compareNumbers(nextRating1.minRt, nextRating2.minRt) ||\r\n        compareSongsByNumAttr(record1, record2, \"level\"));\r\n}\r\nexports.compareSongsByNextRating = compareSongsByNextRating;\r\nfunction compareSongsByLevel(record1, record2) {\r\n    // smaller first\r\n    return compareSongsByNumAttr(record2, record1, \"level\");\r\n}\r\nexports.compareSongsByLevel = compareSongsByLevel;\r\nfunction compareSongsByAchv(record1, record2) {\r\n    return compareSongsByNumAttr(record1, record2, \"achievement\");\r\n}\r\nexports.compareSongsByAchv = compareSongsByAchv;\r\nfunction compareSongsByName(record1, record2) {\r\n    return compareSongsByStrAttr(record1, record2, \"songName\");\r\n}\r\nexports.compareSongsByName = compareSongsByName;\r\nfunction compareSongsByNextRank(record1, record2) {\r\n    const nextRank1 = record1.nextRanks.values().next().value.rank;\r\n    const nextRank2 = record2.nextRanks.values().next().value.rank;\r\n    return compareNumbers(nextRank1.th, nextRank2.th);\r\n}\r\nexports.compareSongsByNextRank = compareSongsByNextRank;\r\nfunction compareSongsByDifficulty(record1, record2) {\r\n    const dIdx1 = constants_1.DIFFICULTIES.indexOf(record1.difficulty);\r\n    const dIdx2 = constants_1.DIFFICULTIES.indexOf(record2.difficulty);\r\n    return compareNumbers(dIdx1, dIdx2);\r\n}\r\nexports.compareSongsByDifficulty = compareSongsByDifficulty;\r\n\n\n//# sourceURL=webpack:///./js/rating-calculator/record-comparator.ts?");

/***/ }),

/***/ "react":
/*!************************!*\
  !*** external "React" ***!
  \************************/
/*! no static exports found */
/***/ (function(module, exports) {

eval("module.exports = React;\n\n//# sourceURL=webpack:///external_%22React%22?");

/***/ }),

/***/ "react-dom":
/*!***************************!*\
  !*** external "ReactDOM" ***!
  \***************************/
/*! no static exports found */
/***/ (function(module, exports) {

eval("module.exports = ReactDOM;\n\n//# sourceURL=webpack:///external_%22ReactDOM%22?");

/***/ })

/******/ });