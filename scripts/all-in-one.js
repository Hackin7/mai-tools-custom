(()=>{"use strict";var e={8642:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getDifficultyTextColor=t.getDifficultyForRecord=t.getDifficultyByName=t.getDifficultyName=t.DIFFICULTY_CLASSNAME_MAP=t.DIFFICULTIES=void 0,t.DIFFICULTIES=[0,1,2,3,4];const i=["BASIC","ADVANCED","EXPERT","MASTER","Re:MASTER"];function o(e){const t=i.indexOf(e.toUpperCase());return t<0?4:t}t.DIFFICULTY_CLASSNAME_MAP=new Map([[0,"basic"],[1,"advanced"],[2,"expert"],[3,"master"],[4,"remaster"]]),t.getDifficultyName=function(e){return i[e]},t.getDifficultyByName=o,t.getDifficultyForRecord=function(e){const t=e.querySelector(".playlog_top_container img.playlog_diff").src;return o(t.substring(t.lastIndexOf("_")+1,t.lastIndexOf(".")))},t.getDifficultyTextColor=function(e){return["#45c124","#ffba01","#ff7b7b","#9f51dc","#dbaaff"][e]}},6162:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getGameRegionFromOrigin=t.isMaimaiNetOrigin=t.MAIMAI_NET_ORIGINS=void 0,t.MAIMAI_NET_ORIGINS=["https://maimaidx.jp","https://maimaidx-eng.com"],t.isMaimaiNetOrigin=function(e){return"https://maimaidx.jp"===e||"https://maimaidx-eng.com"===e},t.getGameRegionFromOrigin=function(e){return"https://maimaidx.jp"===e?"https://maimaidx.jp":"https://maimaidx-eng.com"}},6991:function(e,t,i){var o=this&&this.__awaiter||function(e,t,i,o){return new(i||(i=Promise))((function(n,r){function a(e){try{s(o.next(e))}catch(e){r(e)}}function c(e){try{s(o.throw(e))}catch(e){r(e)}}function s(e){var t;e.done?n(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(a,c)}s((o=o.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.addLvToSongTitle=t.removeScrollControl=t.getEpochTimeFromText=t.fetchGameVersion=t.fetchPage=void 0;const n=i(8642),r="MaiToolsGameVer",a="MaiToolsGameVerExpire",c=6e4*((new Date).getTimezoneOffset()+540);function s(e){return o(this,void 0,void 0,(function*(){const t=yield fetch(e),i=yield t.text();return(new DOMParser).parseFromString(i,"text/html")}))}t.fetchPage=s,t.fetchGameVersion=function e(t){return o(this,void 0,void 0,(function*(){const i=parseInt(window.localStorage.getItem(a));if(!isNaN(i)&&i>=Date.now()){const e=parseInt(window.localStorage.getItem(r));if(!isNaN(e))return e}const o=t.querySelector("select[name=version] option:last-of-type");if(o instanceof HTMLOptionElement){const e=parseInt(o.value);return window.localStorage.setItem(r,String(e)),window.localStorage.setItem(a,String(Date.now()+864e5)),e}return e(t=yield s("/maimai-mobile/record/musicVersion/"))}))},t.getEpochTimeFromText=function(e){const t=e.match(/(\d+)\/(\d+)\/(\d+) (\d+):(\d+)/);return new Date(parseInt(t[1]),parseInt(t[2])-1,parseInt(t[3]),parseInt(t[4]),parseInt(t[5])).getTime()-c},t.removeScrollControl=function(e){let t=e.getElementById("page-top");t&&t.remove(),t=e.getElementById("page-bottom"),t&&t.remove()},t.addLvToSongTitle=function(e,t,i){return o(this,void 0,void 0,(function*(){const o=e.querySelector(".basic_block.break"),r=o.querySelector("img");r&&r.remove();const a=document.createElement("div");a.className="f_r",a.append("Lv "+i),a.style.color=(0,n.getDifficultyTextColor)(t),o.append(a)}))}},4313:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getMaiToolsBaseUrl=t.getScriptHost=void 0;const o=i(6162),n="https://myjian.github.io/mai-tools";t.getScriptHost=function(e){const t=Array.from(document.querySelectorAll("script"));for(;t.length;){const i=t.pop();if(i.src.includes(e)){const e=new URL(i.src),t=e.pathname;return e.origin+t.substring(0,t.lastIndexOf("/scripts"))}}return n},t.getMaiToolsBaseUrl=function(){return(0,o.isMaimaiNetOrigin)(window.location.origin)?n:window.location.pathname.startsWith("/mai-tools")?window.location.origin+"/mai-tools":window.location.origin}}},t={};function i(o){var n=t[o];if(void 0!==n)return n.exports;var r=t[o]={exports:{}};return e[o].call(r.exports,r,r.exports,i),r.exports}(()=>{const e=i(6162),t=i(6991),o=i(4313);!function(i){const n=(0,o.getScriptHost)("all-in-one")+"/scripts/";if(!(0,e.isMaimaiNetOrigin)(i.location.origin))return;function r(e){const t=i.createElement("script");t.src=n+e+"?t="+Math.floor(Date.now()/6e4),i.body.append(t)}const a=i.location.pathname;"/maimai-mobile/record/"===a?r("recent-play-downloader.js"):a.indexOf("/maimai-mobile/record/playlogDetail/")>=0?(r("score-converter.js"),r("play-record-helper.js")):a.indexOf("/maimai-mobile/record/musicDetail/")>=0?((0,t.removeScrollControl)(i),r("song-detail-helper.js")):a.indexOf("/maimai-mobile/record/music")>=0?r("score-sort.js"):a.indexOf("/maimai-mobile/friend/")>=0?(r("analyze-friend-rating-in-new-tab.js"),(a.indexOf("/maimai-mobile/friend/friendGenreVs/battleStart/")>=0||a.indexOf("/maimai-mobile/friend/friendLevelVs/battleStart/")>=0)&&r("score-sort.js")):a.indexOf("/maimai-mobile/home/")>=0||a.indexOf("/maimai-mobile/playerData/")>=0?((0,t.removeScrollControl)(i),r("score-download.js"),r("analyze-rating-in-newtab.js")):a.indexOf("/maimai-mobile/photo/")>=0&&r("album-download-helper.js")}(document)})()})();