(()=>{"use strict";var e={1782:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.EMPTY_JUDGEMENT_OBJ=t.BREAK_BONUS_MULTIPLIER=t.BREAK_BASE_SCORE_MULTIPLIER=t.MAX_BREAK_POINTS=t.BREAK_BONUS_POINTS=t.REGULAR_BASE_SCORE_MULTIPLIER=t.BASE_SCORE_PER_TYPE=t.DX_NOTE_TYPES=void 0,t.DX_NOTE_TYPES=["tap","hold","slide","touch","break"],t.BASE_SCORE_PER_TYPE={tap:500,hold:1e3,touch:500,slide:1500,break:2500},t.REGULAR_BASE_SCORE_MULTIPLIER={cp:1,perfect:1,great:.8,good:.5,miss:0},t.BREAK_BONUS_POINTS=100,t.MAX_BREAK_POINTS=t.BASE_SCORE_PER_TYPE.break+t.BREAK_BONUS_POINTS,t.BREAK_BASE_SCORE_MULTIPLIER=new Map([[t.MAX_BREAK_POINTS,1],[2550,1],[2500,1],[2e3,.8],[1500,.6],[1250,.5],[1e3,.4],[0,0]]),t.BREAK_BONUS_MULTIPLIER=new Map([[t.MAX_BREAK_POINTS,1],[2550,.75],[2500,.5],[2e3,.4],[1500,.4],[1250,.4],[1e3,.3],[0,0]]),t.EMPTY_JUDGEMENT_OBJ={perfect:0,great:0,good:0,miss:0}},6358:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.formatFloat=t.roundFloat=t.sum=t.compareNumber=void 0,t.compareNumber=function(e,t){return e>t?1:e<t?-1:0},t.sum=function(e){let t=0;for(const a of e)t+=a;return t},t.roundFloat=function(e,t,a){return Math[t](e/a)*a},t.formatFloat=function(e,t){return e?e.toFixed(t):"0"}},611:function(e,t,a){var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.DxAchievementCalculator=void 0;const l=n(a(7363)),r=a(1089),u=a(4459);var o;!function(e){e.TotalScore="ts",e.BreakScore="bs",e.BreakJudgement="bj",e.Achievement="achv"}(o||(o={}));class c extends l.default.PureComponent{constructor(e){super(e),this.handleChangeFinaleAchv=e=>{const t=parseFloat(e.currentTarget.value);t>0&&this.setState({finaleAchv:t})},this.handleChangeTotalScore=e=>{const t=parseInt(e.currentTarget.value);if(t>0){const a={[e.currentTarget.name]:t};this.setState(a)}},this.handleChangeBreakJudgement=e=>{const t=parseInt(e.currentTarget.value);if(t>=0){const a=parseInt(e.currentTarget.name.substring(6));this.setState((({breakJudgements:e})=>({breakJudgements:e.map(((e,n)=>n===a?t:e))})))}},this.handleCopyLink=()=>{window.location.assign(this.getUrlForCurrentInput())},this.handleFillExample=e=>{e.preventDefault(),Math.random()>.5?location.assign("?achv=100.46&bs=170850&ts=385300&bj=65-2-0-0"):location.assign("?achv=99.96&bs=64050&ts=380850&bj=24-1-0-0")},this.handleReset=e=>{e.preventDefault(),location.assign("?")};const t=new URLSearchParams(location.search),a=t.get(o.Achievement),n=t.get(o.TotalScore),l=t.get(o.BreakScore),r=t.get(o.BreakJudgement);if(a&&n&&l&&r){const e=parseFloat(a),t=parseInt(n),u=parseInt(l),o=r.split("-"),c=o.map((e=>parseInt(e,10)));if(e>0&&t>0&&u>=0&&4===c.length)return void(this.state={initialFinaleAchvInput:a,finaleAchv:e,initialTotalScoreInput:n,totalScore:t,initialBreakScoreInput:l,breakScore:u,initialBreakJudgementsInput:o,breakJudgements:c})}this.state={initialFinaleAchvInput:"",finaleAchv:0,initialTotalScoreInput:"",totalScore:0,initialBreakScoreInput:"",breakScore:0,initialBreakJudgementsInput:["","","",""],breakJudgements:[0,0,0,0]}}render(){const{finaleAchv:e,initialFinaleAchvInput:t,totalScore:a,initialTotalScoreInput:n,breakScore:o,initialBreakScoreInput:c,breakJudgements:s,initialBreakJudgementsInput:i}=this.state,d=(0,u.calculateDxAchvFromFinaleResult)(e,a,o,s);return l.default.createElement(l.default.Fragment,null,l.default.createElement("form",null,l.default.createElement("div",null,l.default.createElement("button",{onClick:this.handleFillExample},"Fill example data"),l.default.createElement("button",{onClick:this.handleReset},"Reset")),l.default.createElement("div",null,l.default.createElement("strong",null,"Finale Achievement:"),l.default.createElement("br",null),l.default.createElement("input",{onChange:this.handleChangeFinaleAchv,defaultValue:t}),"%"),l.default.createElement("div",null,l.default.createElement("strong",null,"Total Score:"),l.default.createElement("br",null),l.default.createElement("input",{name:"totalScore",onChange:this.handleChangeTotalScore,defaultValue:n})),l.default.createElement("div",null,l.default.createElement("strong",null,"Break Score:"),l.default.createElement("br",null),l.default.createElement("input",{name:"breakScore",defaultValue:c,onChange:this.handleChangeTotalScore})),l.default.createElement("div",null,l.default.createElement("strong",null,"Break Judgements:"),l.default.createElement("br",null),l.default.createElement("div",{className:"judgementInputRow"},l.default.createElement("div",{className:"judgementInputCol perfectJudgement"},"Perfect",l.default.createElement("br",null),l.default.createElement("input",{className:"noteCount",name:"break_0",defaultValue:i[0],onChange:this.handleChangeBreakJudgement})),l.default.createElement("div",{className:"judgementInputCol greatJudgement"},"Great",l.default.createElement("br",null),l.default.createElement("input",{className:"noteCount",name:"break_1",defaultValue:i[1],onChange:this.handleChangeBreakJudgement})),l.default.createElement("div",{className:"judgementInputCol goodJudgement"},"Good",l.default.createElement("br",null),l.default.createElement("input",{className:"noteCount",defaultValue:i[2],name:"break_2",onChange:this.handleChangeBreakJudgement})),l.default.createElement("div",{className:"judgementInputCol missJudgement"},"Miss",l.default.createElement("br",null),l.default.createElement("input",{className:"noteCount",name:"break_3",defaultValue:i[3],onChange:this.handleChangeBreakJudgement}))))),d.size?l.default.createElement("div",{className:"resultHeading"},l.default.createElement("h3",null,this.getDxAchvRange(d)),l.default.createElement("a",{href:this.getUrlForCurrentInput()},"Link to this result")):null,Array.from(d.entries()).map((([e,t],a)=>l.default.createElement(r.DxAchvDetails,{key:a,dxAchv:e,breakDist:t}))),l.default.createElement("button",{className:"copyLink",type:"button",onClick:this.handleCopyLink},"ðŸ“Ž"))}getDxAchvRange(e){let t,a;for(const n of e.keys())t||(t=n),a=n;return t===a?`DX Achievement: ${t}%`:parseFloat(t)<parseFloat(a)?`DX Achievement Range: ${t}% - ${a}%`:`DX Achievement Range: ${a}% - ${t}%`}getUrlForCurrentInput(){const{finaleAchv:e,totalScore:t,breakScore:a,breakJudgements:n}=this.state;return"?"+new URLSearchParams({[o.Achievement]:e.toFixed(2),[o.BreakScore]:a.toString(),[o.TotalScore]:t.toString(),[o.BreakJudgement]:n.join("-")})}}t.DxAchievementCalculator=c},1089:function(e,t,a){var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.DxAchvDetails=void 0;const l=n(a(7363)),r=a(1782);function u(e){return e>2e3?"perfectJudgement":e>1e3?"greatJudgement":e>0?"goodJudgement":"missJudgement"}class o extends l.default.PureComponent{render(){const{dxAchv:e,breakDist:t}=this.props;return l.default.createElement("table",{className:"dxAchvDetails"},l.default.createElement("thead",null,l.default.createElement("tr",null,l.default.createElement("th",{className:"dxAchv",colSpan:8},e,"%")),l.default.createElement("tr",null,Array.from(r.BREAK_BONUS_MULTIPLIER.keys()).map(((e,t)=>l.default.createElement("th",{key:t,className:u(e)},e))))),l.default.createElement("tbody",null,l.default.createElement("tr",null,Array.from(r.BREAK_BONUS_MULTIPLIER.keys()).map(((e,a)=>l.default.createElement("td",{key:a,className:u(e)},t.get(e)))))))}}t.DxAchvDetails=o},4459:(e,t,a)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.calculateDxAchvFromFinaleResult=void 0;const n=a(1782),l=a(6358);function r(e,t,a,n){if(t<0)return;let l=[];switch(e.length){case 0:return 0===t?(n.push(new Map(a)),!0):void 0;case 1:l=[2600,2550,2500];break;case 2:l=[2e3,1500,1250];break;case 3:l=[1e3];break;default:l=[0]}const u=1===e.length,o=e[e.length-1];if(a.get(2e3)&&a.get(1250)&&console.log(o,t),3===l.length)for(let c=o;c>=0;c--){a.set(l[0],c);const s=t-l[0]*c;if(s<0)continue;const i=u?o-c+1>>1:0;for(let t=o-c;t>=i;t--){const i=o-c-t;a.set(l[1],t),a.set(l[2],i);const d=r(e.slice(0,e.length-1),s-l[1]*t-l[2]*i,a,n);if(a.get(2e3)&&a.get(1250)&&console.log(c,t,i,s,d),d&&u)return}}else 1===l.length?(a.set(l[0],o),r(e.slice(0,e.length-1),t-l[0]*o,a,n)):console.error("Unreachable")}t.calculateDxAchvFromFinaleResult=function(e,t,a,u){const o=(0,l.roundFloat)(t/e*100,"floor",50),c=u.reduce(((e,t)=>e+t),0);if(e<=0||t<=0||a>t||o<=0||c<=0)return new Map;const s=[];if(r(u,a,new Map,s),!s.length)return console.warn(`Could not find break distribution for achv=${e}, totalScore=${t}, breakScore=${a}, breakJudgements=${u.join("-")}`),new Map;const i=100*(t-a)/o,d=25e4/o,m=1/c,f=new Map;for(const e of s){let t=i;e.forEach(((e,a)=>{t+=e*n.BREAK_BASE_SCORE_MULTIPLIER.get(a)*d,t+=e*n.BREAK_BONUS_MULTIPLIER.get(a)*m}));const a=(0,l.roundFloat)(t,"floor",1e-4).toFixed(4);f.set(a,e)}return console.log(f),f}},5793:function(e,t,a){var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const l=n(a(7363)),r=n(a(1533)),u=a(611);r.default.render(l.default.createElement(u.DxAchievementCalculator,null),document.getElementById("root"))},7363:e=>{e.exports=React},1533:e=>{e.exports=ReactDOM}},t={};!function a(n){var l=t[n];if(void 0!==l)return l.exports;var r=t[n]={exports:{}};return e[n].call(r.exports,r,r.exports,a),r.exports}(5793)})();