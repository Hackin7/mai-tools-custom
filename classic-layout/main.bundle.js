(()=>{"use strict";var e={7323:(e,t,a)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.calculateAchvLoss=void 0;const n=a(62),o=a(9276);function s(){return Object.assign({total:0},o.EMPTY_JUDGEMENT_OBJ)}t.calculateAchvLoss=function(e,t,a){const r=s(),c=s(),l={dx:new Map,finale:new Map},i=n.sum(Object.values(e.get("break")));return e.forEach(((e,n)=>{const d=o.BASE_SCORE_PER_TYPE[n],u=s(),m=s();if("break"===n)u.perfect=50*t.get(2550)+100*t.get(2500),u.great=600*t.get(2e3)+1100*t.get(1500)+1350*t.get(1250),u.good=1600*t.get(1e3),u.miss=2600*t.get(0),u.total=Object.values(u).reduce(((e,t)=>e+t),0),m.perfect=(t.get(2550)*(1-o.BREAK_BONUS_MULTIPLIER.get(2550))+t.get(2500)*(1-o.BREAK_BONUS_MULTIPLIER.get(2500)))/i,m.great=(t.get(2e3)*(1-o.BREAK_BASE_SCORE_MULTIPLIER.get(2e3))+t.get(1500)*(1-o.BREAK_BASE_SCORE_MULTIPLIER.get(1500))+t.get(1250)*(1-o.BREAK_BASE_SCORE_MULTIPLIER.get(1250)))*d/a+(t.get(2e3)*(1-o.BREAK_BONUS_MULTIPLIER.get(2e3))+t.get(1500)*(1-o.BREAK_BONUS_MULTIPLIER.get(1500))+t.get(1250)*(1-o.BREAK_BONUS_MULTIPLIER.get(1250)))/i,m.good=t.get(1e3)*(1-o.BREAK_BASE_SCORE_MULTIPLIER.get(1e3))*d/a+t.get(1e3)*(1-o.BREAK_BONUS_MULTIPLIER.get(1e3))/i,m.miss=t.get(0)*d/a+t.get(0)/i,m.total=Object.values(m).reduce(((e,t)=>e+t),0);else{u.perfect=0,u.great=Math.round(e.great*d*(1-o.REGULAR_BASE_SCORE_MULTIPLIER.great)),u.good=Math.round(e.good*d*(1-o.REGULAR_BASE_SCORE_MULTIPLIER.good)),u.miss=e.miss*d,u.total=Object.values(u).reduce(((e,t)=>e+t),0);for(const[e,t]of Object.entries(u))m[e]=t/a}for(const[e,t]of Object.entries(u))c[e]+=t;for(const[e,t]of Object.entries(m))r[e]+=t;l.finale.set(n,u),l.dx.set(n,m)})),l.finale.set("total",c),l.dx.set("total",r),l}},3194:(e,t,a)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.walkBreakDistributions=void 0;const n=a(9276);t.walkBreakDistributions=function e(t,a,o,s,r){let c=o[0],l=!1,i=0;switch(o.length){case 5:return a.set(n.MAX_BREAK_POINTS,c),e(t,a,o.slice(1),s,r);case 4:let d=0,u=c;if(a.has(n.MAX_BREAK_POINTS)){const e=a.get(n.MAX_BREAK_POINTS);c+=e,d=e,u=e}for(let m=u;m>=d;m--){a.set(n.MAX_BREAK_POINTS,m);for(let n=c-m;n>=0;n--){a.set(2550,n),a.set(2500,c-m-n);const d=e(t,a,o.slice(1),s,r);if(l||(i=d,l=!0),d<s)break}}return i;case 3:for(let n=c;n>=0;n--){a.set(2e3,n);for(let d=c-n;d>=0;d--){a.set(1500,d),a.set(1250,c-n-d);const u=e(t,a,o.slice(1),s,r);if(l||(i=u,l=!0),u<s)break}}return i;case 2:return a.set(1e3,c),e(t,a,o.slice(1),s,r);case 1:return a.set(0,c),e(t,a,o.slice(1),s,r);case 0:let m=0,f=0,g=0;return a.forEach(((e,t)=>{m+=e,g+=e*n.BREAK_BASE_SCORE_MULTIPLIER.get(t)*r,f+=e*n.BREAK_BONUS_MULTIPLIER.get(t)})),g+=f/m,s-=g,Math.abs(s)<1e-4&&t.push(new Map(a)),g;default:throw new Error("unreachable")}}},4926:function(e,t,a){var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.AchievementInfo=void 0;const o=n(a(3804)),s=a(3073);function r(e,t,a,n){return t?s.getRankTitle(a):"AP+"===n?"SSS+":s.getFinaleRankTitle(e)}function c(e){const t="apfc";return e?"FC+"===e?"apfc fcplus":e.includes("AP")?"apfc ap":t:t}function l(e){return e?"sync":"sync finaleSync"}class i extends o.default.PureComponent{static getDerivedStateFromProps(e){const{dxAchv:t,apFcStatus:a,finaleAchv:n,isDxMode:o}=e;return{rankTitle:r(n,o,t,a)}}componentDidMount(){this.fetchRankImage()}componentDidUpdate(){this.fetchRankImage()}render(){const{apFcStatus:e,apFcImg:t,rankImgMap:a,isHighScore:n,syncStatus:s,syncImg:r,maxFinaleAchv:i,dxAchv:d,finaleAchv:u,isDxMode:m,toggleDisplayMode:f,showMaxAchv:g}=this.props,{rankTitle:p}=this.state,h=a.get(p),E=h?o.default.createElement("img",{className:"rankImg",src:h,alt:p}):p,_=t?o.default.createElement("img",{className:"apFcImg",src:t,alt:e}):e,S=r?o.default.createElement("img",{className:"syncImg",src:r,alt:s}):this.getSyncStatusText(s,m),M=m?d.toFixed(4):u.toFixed(2),A=m?101..toFixed(4):i.toFixed(2);return o.default.createElement("div",{className:"achievementInfo"},o.default.createElement("div",{className:"achvInfoSpace"}),o.default.createElement("div",{className:"rank"},E),o.default.createElement("div",{className:c(e)},_),o.default.createElement("div",{className:l(m)},S),o.default.createElement("div",{className:"playerScore"},o.default.createElement("div",{className:"highScore"},n?"HIGH SCORE!!":" "),o.default.createElement("div",{className:"achievement",tabIndex:0,onClick:f},"達成率：",o.default.createElement("div",{className:"achvNum"+(g?" hasMaxAchv":"")},o.default.createElement("span",{className:"playerAchv"},M,"％"),g&&o.default.createElement("span",{className:"maxAchv"},A,"％")))))}getSyncStatusText(e,t){if(e&&!t)switch(e){case"FS":case"FS+":return"MAX FEVER";case"FDX":case"FDX+":return"100% SYNC"}return e}fetchRankImage(){const{rankImgMap:e,fetchRankImage:t}=this.props,{rankTitle:a}=this.state;e.has(a)||t(a)}}t.AchievementInfo=i},1837:function(e,t,a){var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.BreakNoteJudgement=void 0;const o=n(a(3804)),s=a(7638);class r extends o.default.PureComponent{render(){const{judgements:e,distribution:t,lastColumn:a,isDxMode:n,displayMode:r}=this.props,c=a.isMax?"score maxScore":"score";return"DETAIL"===r?o.default.createElement("tr",{className:"breakNoteRow"},o.default.createElement("th",{className:"rowHead"},"Break"),o.default.createElement("td",{colSpan:3,className:"noRightBorder"},o.default.createElement("div",{className:"breakDistribution"},o.default.createElement("span",{className:"perfect"},t.get(2600)),o.default.createElement("span",{className:"perfect"},t.get(2550)),o.default.createElement("span",{className:"perfect"},t.get(2500)),o.default.createElement("span",{className:"great"},t.get(2e3)),o.default.createElement("span",{className:"great"},t.get(1500)),o.default.createElement("span",{className:"great"},t.get(1250)),o.default.createElement("span",{className:"good"},t.get(1e3)))),o.default.createElement("td",{className:"noLeftBorder"},o.default.createElement("div",{className:"miss missWithBefore"},t.get(0))),o.default.createElement("td",{className:c},s.getLastColumnText(a.score,n))):o.default.createElement(s.NoteJudgement,{noteType:"break",judgements:e,lastColumn:a,isDxMode:n})}}t.BreakNoteJudgement=r},8067:function(e,t,a){var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.CreditInfo=void 0;const o=n(a(3804));class s extends o.default.PureComponent{render(){return o.default.createElement("div",{className:"credit"},o.default.createElement("span",{className:"madeBy"},"Made by"," "),o.default.createElement("a",{className:"authorLink",href:"https://github.com/myjian",target:"_blank"},"myjian"),".")}}t.CreditInfo=s},142:function(e,t,a){var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.DateAndPlace=void 0;const o=n(a(3804));class s extends o.default.PureComponent{render(){const{date:e,isDxMode:t}=this.props,a=t?"でらっくすちほー":"CAFE MiLK";return o.default.createElement("div",{className:"dateAndPlace"},o.default.createElement("div",{className:"date"},e),o.default.createElement("div",{className:"place",tabIndex:0,onClick:this.props.toggleDxMode},a))}}t.DateAndPlace=s},9988:function(e,t,a){var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.JudgementContainer=void 0;const o=n(a(3804)),s=a(1837),r=a(953),c=a(7638);class l extends o.default.PureComponent{render(){const{nextRank:e,noteJudgements:t,breakDistribution:a,totalJudgements:n,scorePerType:l,combo:i,isDxMode:d,displayMode:u}=this.props;return o.default.createElement("div",{className:"judgementContainer"},o.default.createElement("table",{className:"judgement"},o.default.createElement("tbody",null,o.default.createElement("tr",null,o.default.createElement("th",{className:"rowHead"}," "),o.default.createElement("th",{className:"perfect"},"Perfect"),o.default.createElement("th",{className:"great"},"Great"),o.default.createElement("th",{className:"good"},"Good"),o.default.createElement("th",{className:"miss"},"Miss"),o.default.createElement("th",{className:"score"},"Score")),o.default.createElement(c.NoteJudgement,{noteType:"total",judgements:n,lastColumn:l.get("total"),isDxMode:d}),o.default.createElement(r.NextRankInfo,{nextRank:e,showTitle:"NORMAL"!==u}),i&&o.default.createElement("tr",{className:"maxCombo"},o.default.createElement("th",{className:"noRightBorder",colSpan:4},"MAX COMBO"),o.default.createElement("td",{className:"noLeftBorder",colSpan:2},i)),o.default.createElement("tr",{className:"tableSeparator"},o.default.createElement("td",{colSpan:6})),o.default.createElement(c.NoteJudgement,{noteType:"tap",judgements:t.get("tap"),lastColumn:l.get("tap"),isDxMode:d}),o.default.createElement(c.NoteJudgement,{noteType:"hold",judgements:t.get("hold"),lastColumn:l.get("hold"),isDxMode:d}),o.default.createElement(c.NoteJudgement,{noteType:"slide",judgements:t.get("slide"),lastColumn:l.get("slide"),isDxMode:d}),o.default.createElement(c.NoteJudgement,{noteType:"touch",judgements:t.get("touch"),lastColumn:l.get("touch"),isDxMode:d}),o.default.createElement(s.BreakNoteJudgement,{judgements:t.get("break"),distribution:a,lastColumn:l.get("break"),isDxMode:d,displayMode:u}))))}}t.JudgementContainer=l},953:function(e,t,a){var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.NextRankInfo=void 0;const o=n(a(3804));class s extends o.default.PureComponent{constructor(){super(...arguments),this.state={showTitle:!1}}render(){const{nextRank:e,showTitle:t}=this.props,a=t&&e?e.title:"",n=this.getNextRankDiff();return o.default.createElement("tr",{className:"nextRank"},o.default.createElement("th",{className:"noRightBorder",colSpan:4},"NEXT RANK"),o.default.createElement("td",{className:"noLeftBorder",colSpan:2},a&&o.default.createElement("span",{className:"nextRankTitle"},a),n&&o.default.createElement("span",{className:"nextRankDiff"},n)))}getNextRankDiff(){const{nextRank:e}=this.props;if(!e)return"—————";const{diff:t}=e;return"number"==typeof t?Math.round(t)!==t?t.toFixed(4)+"%":t.toLocaleString("en"):t}}t.NextRankInfo=s},7638:function(e,t,a){var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.NoteJudgement=t.getLastColumnText=void 0;const o=n(a(3804)),s=a(62);function r(e,t){return"string"==typeof e?e:t?s.formatFloat(e,4)+"%":e.toLocaleString("en")}t.getLastColumnText=r;class c extends o.default.PureComponent{render(){const{noteType:e,judgements:t,lastColumn:a,isDxMode:n}=this.props;if(!t)return null;const s=e.charAt(0).toUpperCase()+e.substring(1),c=a.isMax?"score maxScore":"score",l=function(e){const t=e.cp;return t?t+e.perfect:e.perfect}(t);return o.default.createElement("tr",{className:e+"NoteRow"},o.default.createElement("th",{className:"rowHead"},s),o.default.createElement("td",{className:"perfect"},l),o.default.createElement("td",{className:"great"},t.great),o.default.createElement("td",{className:"good"},t.good),o.default.createElement("td",{className:"miss"},t.miss),o.default.createElement("td",{className:c},r(a.score,n)))}}t.NoteJudgement=c},5775:function(e,t,a){var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.PageFooter=void 0;const o=n(a(3804));class s extends o.default.PureComponent{render(){return o.default.createElement("div",{className:"pageFooter"},o.default.createElement("a",{className:"closePage",href:"javascript:window.close()"},"戻る"))}}t.PageFooter=s},5818:function(e,t,a){var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.PageTitle=void 0;const o=n(a(3804));class s extends o.default.PureComponent{render(){return o.default.createElement("h3",{className:"pageTitle"},"プレイ履歴")}}t.PageTitle=s},8235:function(e,t,a){var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.RootComponent=void 0;const o=n(a(3804)),s=a(5179),r=a(8067),c=a(5775),l=a(5818),i=a(2589),d=a(5641);function u(e,t){return t=t||2,e.toString().padStart(t,"0")}function m(e,t,a){return e.get(t)||(console.warn('URL does not contain "'+t+'", using default value "'+a+'"'),a)}function f(e,t){const a=m(e,"dt",t.date),n=m(e,"tk",t.track),o=m(e,"df",t.difficulty),r=m(e,"st",t.songTitle),c=m(e,"ac",t.achievement),l=m(e,"hs",t.highScore),i=m(e,"cb",t.combo),d=m(e,"nd",t.noteDetails);return{date:a,track:n,songTitle:r,difficulty:o,syncStatus:m(e,"sc",t.syncStatus),noteJudgements:s.parseJudgements(d),combo:i&&i.replace("/"," / "),highScore:"1"===l,achievement:parseFloat(c)}}class g extends o.default.PureComponent{constructor(e){super(e),this.fetchRankImage=e=>{console.log("fetchRankImage "+e),this.state.rankImg.set(e,null),this.sendMessageToOpener({action:"getRankImage",payload:e})},this.handleWindowMessage=e=>{if("https://maimaidx-eng.com"===e.origin||"https://maimaidx.jp"===e.origin)switch(e.data.action){case"songImage":this.setState({songImg:e.data.imgSrc});break;case"apFcImage":this.setState({apFcImg:URL.createObjectURL(e.data.img)});break;case"syncImage":this.setState({syncImg:URL.createObjectURL(e.data.img)});break;case"rankImage":this.setState((t=>{const a=t.rankImg.get(e.data.title);a&&URL.revokeObjectURL(a);const n=new Map(t.rankImg);return n.set(e.data.title,URL.createObjectURL(e.data.img)),{rankImg:n}}));break;default:console.log(e.data)}},window.opener&&document.referrer&&(this.openerOrigin=new URL(document.referrer).origin);const t=new URLSearchParams(document.location.search),a={date:(n=new Date,n.getFullYear()+"-"+u(n.getMonth()+1)+"-"+u(n.getDate())+" "+u(n.getHours())+":"+u(n.getMinutes())),track:"TRACK "+(Math.floor(3*Math.random())+1),songTitle:"分からない",achievement:"95.3035%",highScore:Math.random()>.9?"1":"0",noteDetails:"654-96-31-28\n25-0-0-0\n78-0-0-1\n\n37-2-1-0"};var n;try{this.state=Object.assign(Object.assign({},f(t,a)),{rankImg:new Map})}catch(e){console.error(e.message),console.error(e.stack),this.state=Object.assign(Object.assign({},f(new URLSearchParams(""),a)),{rankImg:new Map,showError:!0})}}componentDidMount(){document.title=this.state.songTitle+" - maimai classic score layout",window.addEventListener("message",this.handleWindowMessage),this.sendMessageToOpener({action:"ready"})}render(){const{achievement:e,combo:t,date:a,difficulty:n,highScore:s,noteJudgements:u,songTitle:m,track:f,songImg:g,apFcImg:p,rankImg:h,syncImg:E,syncStatus:_,showError:S}=this.state;return o.default.createElement(o.default.Fragment,null,o.default.createElement("div",{className:"widthLimit"},o.default.createElement("div",{className:"container"},o.default.createElement(l.PageTitle,null),o.default.createElement(d.SectionSep,null),S?o.default.createElement("div",{className:"error"},"Failed to parse input. Please contact the developer!"):o.default.createElement(i.ScorePageContainer,{achievement:e,combo:t,date:a,difficulty:n,highScore:s,noteJudgements:u,songTitle:m,track:f,syncStatus:_,songImgSrc:g,apFcImg:p,rankImg:h,syncImg:E,fetchRankImage:this.fetchRankImage}),o.default.createElement(d.SectionSep,null),o.default.createElement(c.PageFooter,null))),o.default.createElement(r.CreditInfo,null))}sendMessageToOpener(e){this.openerOrigin&&(console.log("sending message to opener",e),window.opener.postMessage(e,this.openerOrigin))}}t.RootComponent=g},5696:function(e,t,a){var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.ScorePage=void 0;const o=n(a(3804)),s=a(1134),r=a(62),c=a(3073),l=a(4926),i=a(142),d=a(9988),u=a(9145),m=a(5505);function f(e,t){return t?"-"+r.formatFloat(e,t)+"%":"-"+e.toLocaleString("en")}class g extends o.default.PureComponent{constructor(){super(...arguments),this.state={isDxMode:!1,displayMode:"NORMAL"},this.toggleDxMode=()=>{this.setState((e=>{const t=!e.isDxMode,{displayMode:a}=e;return{isDxMode:t,displayNoteJudgements:this.getNoteJudgementLoss(t,a),displayScorePerType:this.getDisplayScorePerType(t,a)}}))},this.toggleDisplayMode=()=>{this.setState((e=>{const t=function(e){switch(e){case"NORMAL":return"LOSS";case"LOSS":return"DETAIL";default:return"NORMAL"}}(e.displayMode),{isDxMode:a}=e;return{displayMode:t,displayNoteJudgements:this.getNoteJudgementLoss(a,t),displayScorePerType:this.getDisplayScorePerType(a,t)}}))}}render(){const{achievement:e,apFcImg:t,rankImg:a,syncImg:n,highScore:s,date:r,songTitle:c,track:f,difficulty:g,songImgSrc:p,noteJudgements:h,combo:E,syncStatus:_,apFcStatus:S,finaleAchievement:M,maxFinaleScore:A,breakDistribution:v,totalJudgements:R,playerScorePerType:I}=this.props,{isDxMode:N,displayMode:P,displayScorePerType:y,displayNoteJudgements:k}=this.state;return o.default.createElement("div",{className:"songScoreContainer"},o.default.createElement(i.DateAndPlace,{date:r,isDxMode:N,toggleDxMode:this.toggleDxMode}),o.default.createElement("div",{className:"songScoreBody"},o.default.createElement("hr",{className:"trackTopLine"}),o.default.createElement(m.SongInfo,{songTitle:c,track:f,difficulty:g}),o.default.createElement(u.SongImg,{imgSrc:p}),o.default.createElement(l.AchievementInfo,{apFcStatus:S,apFcImg:t,rankImgMap:a,syncStatus:_,syncImg:n,isDxMode:N,isHighScore:s,dxAchv:e,finaleAchv:M,maxFinaleAchv:A,showMaxAchv:"NORMAL"!==P,toggleDisplayMode:this.toggleDisplayMode,fetchRankImage:this.props.fetchRankImage}),o.default.createElement(d.JudgementContainer,{noteJudgements:k||h,breakDistribution:v,totalJudgements:k?k.get("total"):R,scorePerType:y||I,nextRank:this.getNextRankEntry(N),combo:E,isDxMode:N,displayMode:P})))}getNextRankEntry(e){const t=e?this.props.achievement:this.props.finaleAchievement;if(e){if(101===t)return;if(t>=100.5)return{title:"AP+",diff:101-t};const e=c.getRankDefinitions(s.DX_SPLASH_GAME_VERSION)[c.getRankIndexByAchievement(t)-1];return{title:e.title,diff:e.minAchv-t}}let a;return this.props.finaleBorder.forEach(((e,t)=>{e>0&&!a&&(a={title:t,diff:e})})),a}getNoteJudgementLoss(e,t){if("LOSS"===t){const t=e?this.props.achvLossDetail.dx:this.props.achvLossDetail.finale,a=e?2:0,n=new Map;return t.forEach(((e,t)=>{n.set(t,{perfect:f(e.perfect,a),great:f(e.great,a),good:f(e.good,a),miss:f(e.miss,a)})})),n}}getDisplayScorePerType(e,t){const{achvLossDetail:a}=this.props,n=e?a.dx:a.finale;if("LOSS"===t){const t=e?4:0,a=new Map;return n.forEach(((e,n)=>{const o=0===e.total,s=f(e.total,t);a.set(n,{isMax:o,score:s})})),a}return e?this.props.dxAchvPerType:this.props.playerScorePerType}}t.ScorePage=g},2589:function(e,t,a){var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.ScorePageContainer=void 0;const o=n(a(3804)),s=a(5136),r=a(5696);class c extends o.default.PureComponent{static getDerivedStateFromProps(e){const t=s.calculateScoreInfo(e.noteJudgements,e.achievement),a=function(e){const t={perfect:0,great:0,good:0,miss:0};return e.forEach((e=>{Object.keys(e).forEach((a=>{let n=a;const o=e[n];"cp"===n&&(n="perfect"),t[n]+=o}))})),t}(e.noteJudgements),n=function(e,t){return e.miss?null:0===t.get("AP+")?"AP+":e.good?"FC":e.great?"FC+":"AP"}(a,t.finaleBorder);return Object.assign(Object.assign({},t),{totalJudgements:a,apFcStatus:n})}render(){return o.default.createElement(r.ScorePage,Object.assign({},this.props,this.state))}}t.ScorePageContainer=c},5641:function(e,t,a){var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.SectionSep=void 0;const o=n(a(3804));class s extends o.default.PureComponent{render(){return o.default.createElement("div",{className:"pageSectionSeparator"})}}t.SectionSep=s},9145:function(e,t,a){var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.SongImg=void 0;const o=n(a(3804));class s extends o.default.PureComponent{render(){const{imgSrc:e}=this.props;return o.default.createElement("div",{className:"songImgContainer"},e?o.default.createElement("img",{className:"songImg",src:e,alt:""}):o.default.createElement("div",{className:"songImg songImgPlaceholder"}),o.default.createElement("div",{className:"songImgReflecContainer"},this.getReflecElement(e)))}getReflecElement(e){if(e){const t={backgroundImage:`url("${e}")`};return o.default.createElement("div",{className:"songImgReflec",style:t})}return o.default.createElement("div",{className:"songImgPlaceholder songImgReflecPlaceholder"})}}t.SongImg=s},5505:function(e,t,a){var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.SongInfo=void 0;const o=n(a(3804)),s=a(3600),r=o.default.memo((e=>{const{difficulty:t}=e;if(!t)return null;const a=t.toLowerCase().replace(":","");return o.default.createElement("span",{className:"difficulty "+a},"【",o.default.createElement("span",{id:"difficulty"},t),"】")}));class c extends o.default.PureComponent{render(){const{songTitle:e,track:t,difficulty:a}=this.props;return o.default.createElement("div",{className:"songInfoContainer"},o.default.createElement("div",null,o.default.createElement("span",{className:"track",id:"track"},t),o.default.createElement(r,{difficulty:a})),o.default.createElement("h2",{className:"songTitle",id:"songTitle"},o.default.createElement("a",{className:"songWikiLink",href:s.getZhWikiLink(e),target:"_blank"},e)))}}t.SongInfo=c},9276:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.EMPTY_JUDGEMENT_OBJ=t.BREAK_BONUS_MULTIPLIER=t.BREAK_BASE_SCORE_MULTIPLIER=t.MAX_BREAK_POINTS=t.BREAK_BONUS_POINTS=t.REGULAR_BASE_SCORE_MULTIPLIER=t.BASE_SCORE_PER_TYPE=t.DX_NOTE_TYPES=void 0,t.DX_NOTE_TYPES=["tap","hold","slide","touch","break"],t.BASE_SCORE_PER_TYPE={tap:500,hold:1e3,touch:500,slide:1500,break:2500},t.REGULAR_BASE_SCORE_MULTIPLIER={cp:1,perfect:1,great:.8,good:.5,miss:0},t.BREAK_BONUS_POINTS=100,t.MAX_BREAK_POINTS=t.BASE_SCORE_PER_TYPE.break+t.BREAK_BONUS_POINTS,t.BREAK_BASE_SCORE_MULTIPLIER=new Map([[t.MAX_BREAK_POINTS,1],[2550,1],[2500,1],[2e3,.8],[1500,.6],[1250,.5],[1e3,.4],[0,0]]),t.BREAK_BONUS_MULTIPLIER=new Map([[t.MAX_BREAK_POINTS,1],[2550,.75],[2500,.5],[2e3,.4],[1500,.4],[1250,.4],[1e3,.3],[0,0]]),t.EMPTY_JUDGEMENT_OBJ={perfect:0,great:0,good:0,miss:0}},3298:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.convertJudgementsToArray=void 0,t.convertJudgementsToArray=function(e){return"number"==typeof e.cp?[e.cp,e.perfect,e.great,e.good,e.miss]:[e.perfect,e.great,e.good,e.miss]}},9034:function(e,t,a){var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const o=n(a(3804)),s=n(a(7196)),r=a(8235);s.default.render(o.default.createElement(r.RootComponent,null),document.getElementById("root"))},5179:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.parseJudgements=void 0;const a={cp:0,perfect:0,great:0,good:0,miss:0};function n(e,t){const a=e.match(/\d+/g);if(!a)return t;if(a.length<4)throw new Error("Cannot parse note judgements");const n=a.map((e=>parseInt(e,10)));return n.length>4?{cp:n[0],perfect:n[1],great:n[2],good:n[3],miss:n[4]}:{perfect:n[0],great:n[1],good:n[2],miss:n[3]}}t.parseJudgements=function(e){let t=e.split("_");if(1===t.length&&(t=e.split("\n")),t.length<4)throw new Error("Cannot parse note judgement lines");const o=new Map,s=n(t.pop(),a);o.set("break",s);const r=n(t.pop(),void 0);r&&o.set("touch",r);const c=n(t.pop(),a);o.set("slide",c);const l=n(t.pop(),a);o.set("hold",l);const i=n(t.pop(),a);return o.set("tap",i),o}},5136:(e,t,a)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.calculateScoreInfo=void 0;const n=a(62),o=a(7323),s=a(3194),r=a(9276),c=a(3298);function l(e,t,a,o){if("AP+"===a)return e+t*r.BREAK_BONUS_POINTS-o;const s=e*a-o;return s<0?-1:n.roundFloat(s,"ceil",50)}t.calculateScoreInfo=function(e,t){let a=0,i=0;const d=new Map([["tap",{score:0,isMax:!1}],["hold",{score:0,isMax:!1}],["slide",{score:0,isMax:!1}],["touch",{score:0,isMax:!1}],["break",{score:0,isMax:!1}],["total",{score:0,isMax:!1}]]),u=new Map;e.forEach(((e,t)=>{const o=r.BASE_SCORE_PER_TYPE[t],s=n.sum(Object.values(e))*o;if(a+=s,"break"!==t){let a=0;Object.keys(e).forEach((t=>{const n=t,s=e[n];a+=s*o*r.REGULAR_BASE_SCORE_MULTIPLIER[n]}));const n=s-a;d.set(t,{score:a,isMax:0===n}),u.set(t,n),i+=a}}));const m=a/100,f=t-i/m,g=r.BASE_SCORE_PER_TYPE.break/m,p=[],h=e.get("break");s.walkBreakDistributions(p,new Map,c.convertJudgementsToArray(h),f,g),console.log("valid break distributions",p);let E=p[0];E||(console.warn("Could not find a valid break distribution!"),console.warn("Please report the issue to the developer."),E=new Map([[r.MAX_BREAK_POINTS,h.cp||0],[2550,0],[2500,h.perfect],[2e3,0],[1500,0],[1250,h.great],[1e3,h.good],[0,h.miss]]));let _=0,S=0;E.forEach(((e,t)=>{_+=e,S+=e*t})),d.set("break",{score:S,isMax:_===E.get(2600)});const M=i+S,A=a+r.BREAK_BONUS_POINTS*_;d.set("total",{score:M,isMax:M===A});const v=n.roundFloat(M/m,"floor",.01),R=n.roundFloat(A/m,"floor",.01);console.log("player score per note type",d);const I=new Map;I.set("tap",{score:n.roundFloat(d.get("tap").score/m,"round",1e-4),isMax:d.get("tap").isMax}),I.set("hold",{score:n.roundFloat(d.get("hold").score/m,"round",1e-4),isMax:d.get("hold").isMax}),I.set("slide",{score:n.roundFloat(d.get("slide").score/m,"round",1e-4),isMax:d.get("slide").isMax}),I.set("touch",{score:n.roundFloat(d.get("touch").score/m,"round",1e-4),isMax:d.get("touch").isMax}),I.set("break",{score:n.roundFloat(f,"round",1e-4),isMax:d.get("break").isMax}),I.set("total",{score:n.roundFloat(t,"round",1e-4),isMax:d.get("total").isMax});const N=o.calculateAchvLoss(e,E,m);console.log("achievement loss detail",N);const P=new Map([["S",l(a,_,.97,M)],["S+",l(a,_,.98,M)],["SS",l(a,_,.99,M)],["SS+",l(a,_,.995,M)],["SSS",l(a,_,1,M)],["AP+",l(a,_,"AP+",M)]]),y=new Map,k=500/m,O=1/_;return y.set("tap",k),y.set("hold",2*k),y.set("slide",3*k),y.set("touch",k),y.set("breakDx",5*k+O),y.set("break",5.2*k),{finaleAchievement:v,maxFinaleScore:R,breakDistribution:E,achvLossDetail:N,finaleBorder:P,pctPerNoteType:y,playerScorePerType:d,dxAchvPerType:I}}},1134:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.DX_SPLASH_PLUS_GAME_VERSION=t.DX_SPLASH_GAME_VERSION=t.DX_PLUS_GAME_VERSION=t.DX_GAME_VERSION=t.SSSPLUS_MIN_ACHIEVEMENT=t.DIFFICULTY_CLASSNAME_MAP=t.DIFFICULTIES=void 0,t.DIFFICULTIES=["BASIC","ADVANCED","EXPERT","MASTER","Re:MASTER"],t.DIFFICULTY_CLASSNAME_MAP=new Map([["Re:MASTER","remaster"],["MASTER","master"],["EXPERT","expert"],["ADVANCED","advanced"]]),t.SSSPLUS_MIN_ACHIEVEMENT=100.5,t.DX_GAME_VERSION=13,t.DX_PLUS_GAME_VERSION=14,t.DX_SPLASH_GAME_VERSION=15,t.DX_SPLASH_PLUS_GAME_VERSION=16},62:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.formatFloat=t.roundFloat=t.sum=t.compareNumber=void 0,t.compareNumber=function(e,t){return e>t?1:e<t?-1:0},t.sum=function(e){let t=0;for(const a of e)t+=a;return t},t.roundFloat=function(e,t,a){return Math[t](e/a)*a},t.formatFloat=function(e,t){return e?e.toFixed(t):"0"}},3073:(e,t,a)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getFinaleRankTitle=t.getRankTitle=t.getRankByAchievement=t.getRankIndexByAchievement=t.getRankDefinitions=t.RANK_DEFINITIONS_SPLASH_PLUS=void 0;const n=a(1134),o=[{minAchv:100.5,factor:14,title:"SSS+"},{minAchv:100,factor:13.5,title:"SSS"},{minAchv:99.5,factor:13.2,title:"SS+"},{minAchv:99,factor:13,title:"SS"},{minAchv:98,factor:12.7,title:"S+"},{minAchv:97,factor:12.5,title:"S"},{minAchv:94,factor:10.5,title:"AAA"},{minAchv:90,factor:9.5,title:"AA"},{minAchv:80,factor:8.5,title:"A"},{minAchv:75,factor:7.5,title:"BBB"},{minAchv:70,factor:7,title:"BB"},{minAchv:60,factor:6,title:"B"},{minAchv:50,factor:5,title:"C"}];function s(e){return e>n.DX_SPLASH_GAME_VERSION?t.RANK_DEFINITIONS_SPLASH_PLUS:o}function r(e){return o.findIndex((t=>e>=t.minAchv))}function c(e){const t=r(e);return t<0?"D":o[t].title}t.RANK_DEFINITIONS_SPLASH_PLUS=[{minAchv:100.5,factor:22.4,title:"SSS+"},{minAchv:100,factor:21.6,title:"SSS"},{minAchv:99.5,factor:21.1,title:"SS+"},{minAchv:99,factor:20.8,title:"SS"},{minAchv:98,factor:20.3,title:"S+"},{minAchv:97,factor:20,title:"S"},{minAchv:94,factor:16.8,title:"AAA"},{minAchv:90,factor:15.2,title:"AA"},{minAchv:80,factor:13.6,title:"A"},{minAchv:75,factor:12,title:"BBB"},{minAchv:70,factor:11.2,title:"BB"},{minAchv:60,factor:9.6,title:"B"},{minAchv:50,factor:8,title:"C"}],t.getRankDefinitions=s,t.getRankIndexByAchievement=r,t.getRankByAchievement=function(e,t){const a=r(e);return a<0?null:s(t)[a]},t.getRankTitle=c,t.getFinaleRankTitle=function(e){return c(e).replace("SSS+","SSS")}},3600:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getZhWikiLink=void 0,t.getZhWikiLink=function(e){return"https://maimai.fandom.com/zh/wiki/"+encodeURIComponent(e)+"?variant=zh-hant"}},3804:e=>{e.exports=React},7196:e=>{e.exports=ReactDOM}},t={};!function a(n){var o=t[n];if(void 0!==o)return o.exports;var s=t[n]={exports:{}};return e[n].call(s.exports,s,s.exports,a),s.exports}(9034)})();